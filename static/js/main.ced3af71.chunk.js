(this["webpackJsonphk-independent-bus-eta"]=this["webpackJsonphk-independent-bus-eta"]||[]).push([[0],{169:function(t){t.exports=JSON.parse('{"en":{"translation":{"kmb":"KMB","ctb":"CTB","nwfb":"NWFB","\u521d\u59cb\u8a2d\u5b9a":"Initizaling","\u6b63\u5728\u66f4\u65b0\u5df4\u58eb\u8def\u7dda\u8cc7\u6599":"ppdating route database","\u7d04\u9700":"approx. ","\u555f\u52d5\u4e2d":"Launching","\u4ecb\u9762\u958b\u555f\u4e2d":"Panel opening","\u7c73":"m","\u79d2":"s","\u5f80":"To","\u5206\u9418":"min","\u5e38\u7528":"Home","\u641c\u5c0b":"Search","\u8a2d\u5b9a":"Settings","\u53d6\u6d88":"Clear","\u5df4\u58eb\u7dda":"Route","\u67b6\u69cb\u7248\u672c":"Schema Version","\u66f4\u65b0\u6642\u9593":"Last Update time","\u5730\u7406\u4f4d\u7f6e\u5b9a\u4f4d\u529f\u80fd":"Geolocation","\u958b\u555f":"On","\u95dc\u9589":"Off","\u4e00\u9375\u6e05\u7a7a\u7528\u6236\u8a18\u9304":"Clear Your Usage Records","\u5305\u62ec\u9396\u5b9a\u548c\u5e38\u7528\u5831\u6642":"Includes saved and common use ETA","\u4ea4\u901a\u8cc7\u6599\u4f86\u6e90":"ETA data source","\u8cc7\u6599\u4e00\u7dda\u901a":"DATA.GOV.HK","\u6350\u6b3e\u652f\u6301":"Donate Now","\u8acb\u6350\u6b3e\u5230 612 \u4eba\u9053\u652f\u63f4\u57fa\u91d1":"Please donate to 612 Humanitarian Relief Fund","\u8907\u88fd\u61c9\u7528\u7a0b\u5f0f\u93c8\u7d50":"Copy App URL","\u7d93\u4e0d\u540c\u5a92\u4ecb\u5206\u4eab\u7d66\u89aa\u53cb":"Share it!"}},"zh":{"translation":{"kmb":"\u4e5d\u5df4","ctb":"\u57ce\u5df4","nwfb":"\u65b0\u5df4"}}}')},180:function(t,e,n){},181:function(t,e,n){},249:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),c=n(18),o=n.n(c),i=(n(180),n(181),n(291)),s=n(293),u=n(17),l=n(27),b=n(290),d=n(277),j=n(250),f=n(102),h=n(292),p=n(273),g=n(299),O=n(7),x=n(272),m=n(296),v=n(295),k=n(274),S=n(6),y=n(8),C=n(118),w=n.n(C),I=n(119),N=n(146),E=n(23),T=n.n(E),L={co:"kmb",fetchRouteList:function(){return fetch("https://data.etabus.gov.hk/v1/transport/kmb/route/").then((function(t){return t.json()})).then((function(t){return t.data.reduce((function(t,e){return t[[e.route,e.service_type,e.bound].join("+")]={route:e.route,co:"kmb",bound:e.bound,orig:{en:e.orig_en.replace("/","\uff0f"),zh:e.orig_tc.replace("/","\uff0f")},dest:{en:e.dest_en.replace("/","\uff0f"),zh:e.dest_tc.replace("/","\uff0f")},stops:[],serviceType:parseInt(e.service_type,10)},t}),{})})).then((function(t){return fetch("https://data.etabus.gov.hk/v1/transport/kmb/route-stop/").then((function(t){return t.json()})).then((function(e){var n=e.data;e.generated_timestamp;return n.forEach((function(e){t[[e.route,e.service_type,e.bound].join("+")].stops.push(e.stop)})),Object.entries(t).map((function(t){var e=Object(y.a)(t,2);e[0];return e[1]}))}))}))},fetchStopList:function(){return fetch("https://data.etabus.gov.hk/v1/transport/kmb/stop").then((function(t){return t.json()})).then((function(t){var e=t.data,n=(t.generated_timestamp,{});return e.forEach((function(t){n[t.stop]={name:{en:t.name_en.replace("/","\uff0f"),zh:R(t.name_tc).replace("/","\uff0f")},location:{lat:parseFloat(t.lat),lng:parseFloat(t.long)}}})),n}))},fetchRouteStops:function(t){t.route,t.bound,t.serviceType;return null},fetchEtas:function(t){var e=t.stopId,n=t.route,a=t.seq,r=t.serviceType,c=t.bound;return fetch("https://data.etabus.gov.hk/v1/transport/kmb/eta/".concat(e,"/").concat(n,"/").concat(r),{cache:"no-store"}).then((function(t){return t.json()})).then((function(t){return t.data.filter((function(t){return t.dir===c&&t.seq===a+1})).map((function(t){return{eta:t.eta,remark:{zh:t.rmk_tc,en:t.rmk_en},co:"kmb"}}))}))},fetchStopEtas:function(t){return fetch("https://data.etabus.gov.hk/v1/transport/kmb/stop-eta/".concat(t),{cache:"no-store"}).then((function(t){return t.json()})).then((function(t){return t.data.map((function(t){return{route:t.route,bound:t.dir,seq:t.seq,eta:t.eta?Math.round(T()(t.eta).diff(T()())/60/1e3):t.eta,dest:{zh:t.dest_tc,en:t.dest_en},remark:{zh:t.rmk,en:t.rmk},serviceType:t.service_type,co:"kmb"}}))}))}},R=function(t){return"\u761d\u55f5\u770e\ufffd\ud85e\ude3e\ufffd\ufffd\ufffd"===t?"\u6c99\u7530\u5773\u9053":"\u66ba\ufffd\u61ad\u627e\ufffd\u55f5\ufffd\ufffd"===t?"\u9ec3\u5927\u4ed9\u7ad9":t},z={co:"nwfb",fetchRouteList:function(){return fetch("https://rt.data.gov.hk/v1/transport/citybus-nwfb/route/nwfb").then((function(t){return t.json()})).then((function(t){return t.data.reduce((function(t,e){return t.concat([{route:e.route,bound:"O",orig:{en:e.orig_en.replace("/","\uff0f"),zh:e.orig_tc.replace("/","\uff0f")},dest:{en:e.dest_en.replace("/","\uff0f"),zh:e.dest_tc.replace("/","\uff0f")},co:"nwfb",stops:null,serviceType:1},{route:e.route,bound:"I",orig:{en:e.dest_en.replace("/","\uff0f"),zh:e.dest_tc.replace("/","\uff0f")},dest:{en:e.orig_en.replace("/","\uff0f"),zh:e.orig_tc.replace("/","\uff0f")},co:"nwfb",stops:null,serviceType:1}])}),[])}))},fetchRouteStops:function(t){var e=t.route,n=t.bound;if(!n)return null;var a="I"===n?"inbound":"outbound";return fetch("https://rt.data.gov.hk/v1/transport/citybus-nwfb/route-stop/NWFB/".concat(e,"/").concat(a)).then((function(t){return t.json()})).then((function(t){return t.data.map((function(t){return t.stop}))})).then((function(t){return Promise.all(t.map((function(t){return fetch("https://rt.data.gov.hk/v1/transport/citybus-nwfb/stop/".concat(t)).then((function(t){return t.json()})).then((function(e){var n=e.data;return{stopId:t,name:{zh:n.name_tc.replace("/","\uff0f"),en:n.name_en.replace("/","\uff0f")},location:{lat:parseFloat(n.lat),lng:parseFloat(n.long)}}}))}))).then((function(e){var n={};return e.forEach((function(t){return n[t.stopId]=t})),{routeStops:t,stopList:n,co:"nwfb"}}))}))},fetchEtas:function(t){var e=t.stopId,n=t.route,a=t.bound;return fetch("https://rt.data.gov.hk//v1/transport/citybus-nwfb/eta/NWFB/".concat(e,"/").concat(n),{cache:"no-store"}).then((function(t){return t.json()})).then((function(t){return t.data.filter((function(t){return t.eta&&t.dir===a})).map((function(t){return{eta:t.eta,remark:{zh:t.rmk_tc,en:t.rmk_en},co:"nwfb"}}))}))},fetchStopEtas:function(t){return fetch("https://rt.data.gov.hk/v1/transport/batch/stop-eta/NWFB/".concat(t),{cache:"no-store"}).then((function(t){return t.json()})).then((function(t){return t.data.map((function(t){return{route:t.route,bound:t.dir,seq:t.seq,eta:t.eta?Math.round(T()(t.eta).diff(T()())/60/1e3):t.eta,dest:{en:t.dest.replace("/","\uff0f")},remark:{en:t.rmk},serviceType:1,co:"nwfb"}}))}))}},_={co:"ctb",fetchRouteList:function(){return fetch("https://rt.data.gov.hk/v1/transport/citybus-nwfb/route/ctb").then((function(t){return t.json()})).then((function(t){return t.data.reduce((function(t,e){return t.concat([{route:e.route,bound:"O",orig:{en:e.orig_en.replace("/","\uff0f"),zh:e.orig_tc.replace("/","\uff0f")},dest:{en:e.dest_en.replace("/","\uff0f"),zh:e.dest_tc.replace("/","\uff0f")},co:"ctb",stops:null,serviceType:1},{route:e.route,bound:"I",orig:{en:e.dest_en.replace("/","\uff0f"),zh:e.dest_tc.replace("/","\uff0f")},dest:{en:e.orig_en.replace("/","\uff0f"),zh:e.orig_tc.replace("/","\uff0f")},co:"ctb",stops:null,serviceType:1}])}),[])}))},fetchRouteStops:function(t){var e=t.route,n=t.bound;if(!n)return null;var a="I"===n?"inbound":"outbound";return fetch("https://rt.data.gov.hk/v1/transport/citybus-nwfb/route-stop/CTB/".concat(e,"/").concat(a)).then((function(t){return t.json()})).then((function(t){return t.data.map((function(t){return t.stop}))})).then((function(t){return Promise.all(t.map((function(t){return fetch("https://rt.data.gov.hk/v1/transport/citybus-nwfb/stop/".concat(t)).then((function(t){return t.json()})).then((function(e){var n=e.data;return{stopId:t,name:{zh:n.name_tc.replace("/","\uff0f"),en:n.name_en.replace("/","\uff0f")},location:{lat:parseFloat(n.lat),lng:parseFloat(n.long)}}}))}))).then((function(e){var n={};return e.forEach((function(t){return n[t.stopId]=t})),{routeStops:t,stopList:n,co:"ctb"}}))}))},fetchEtas:function(t){var e=t.stopId,n=t.route,a=t.bound;return fetch("https://rt.data.gov.hk//v1/transport/citybus-nwfb/eta/CTB/".concat(e,"/").concat(n),{cache:"no-store"}).then((function(t){return t.json()})).then((function(t){return t.data.filter((function(t){return t.eta&&t.dir===a})).map((function(t){return{eta:t.eta,remark:{zh:t.rmk_tc,en:t.rmk_en},co:"ctb"}}))}))},fetchStopEtas:function(t){return fetch("https://rt.data.gov.hk/v1/transport/batch/stop-eta/CTB/".concat(t),{cache:"no-store"}).then((function(t){return t.json()})).then((function(t){return t.data.map((function(t){return{route:t.route,bound:t.dir,seq:t.seq,eta:t.eta?Math.round(T()(t.eta).diff(T()())/60/1e3):t.eta,dest:{en:t.dest.replace("/","\uff0f")},remark:{en:t.rmk},serviceType:1,co:"ctb"}}))}))}},P=function(){var t=Object(N.a)(w.a.mark((function t(e){var n,a,r,c,o,i,s,u,l,b;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.route,a=e.routeStops,r=e.bound,c=e.seq,o=e.serviceType,i=e.co,s=[],u=Object(I.a)(i),t.prev=3,u.s();case 5:if((l=u.n()).done){t.next=31;break}if("kmb"!==(b=l.value)||!a.kmb){t.next=15;break}return t.t0=s,t.next=11,L.fetchEtas({route:n,stopId:a.kmb[c],seq:c+1===a.kmb.length?1e3:c,serviceType:o,bound:r[b]});case 11:t.t1=t.sent,s=t.t0.concat.call(t.t0,t.t1),t.next=29;break;case 15:if("ctb"!==b||!a.ctb){t.next=23;break}return t.t2=s,t.next=19,_.fetchEtas({stopId:a.ctb[c],route:n,bound:r[b]});case 19:t.t3=t.sent,s=t.t2.concat.call(t.t2,t.t3),t.next=29;break;case 23:if("nwfb"!==b||!a.nwfb){t.next=29;break}return t.t4=s,t.next=27,z.fetchEtas({stopId:a.nwfb[c],route:n,bound:r[b]});case 27:t.t5=t.sent,s=t.t4.concat.call(t.t4,t.t5);case 29:t.next=5;break;case 31:t.next=36;break;case 33:t.prev=33,t.t6=t.catch(3),u.e(t.t6);case 36:return t.prev=36,u.f(),t.finish(36);case 39:return t.abrupt("return",s.sort((function(t,e){return""===t.eta?1:""===e.eta||t.eta<e.eta?-1:1})));case 40:case"end":return t.stop()}}),t,null,[[3,33,36,39]])})));return function(e){return t.apply(this,arguments)}}(),F=function(t){var e=t.route,n=t.bound,a=t.stops;return Promise.all([L,z,_].map((function(t){return a[t.co]?null:t.fetchRouteStops({route:e,bound:n[t.co]})})).filter((function(t){return t})))},B=function(t,e){var n=t.toUpperCase(),a=e.toUpperCase();return n.includes(a)||a.includes(n)},M=function(t,e){return t.route===e.route&&t.co!==e.co&&["orig","dest"].map((function(n){return B(t[n].en,e[n].en)})).includes(!0)},J=function(t){var e={route:t.route,co:[t.co],bound:{},orig:{en:t.orig.en,zh:t.orig.zh},dest:{en:t.dest.en,zh:t.dest.zh},stops:{},serviceType:t.serviceType};return e.stops[t.co]=t.stops,e.bound[t.co]=t.bound,e},W=n(2),D=r.a.createContext(),q=function(t){var e=Object(a.useState)(localStorage.getItem("schemaVersion")),n=Object(y.a)(e,2),r=n[0],c=n[1],o=Object(a.useState)(JSON.parse(localStorage.getItem("routeList"))),i=Object(y.a)(o,2),s=i[0],u=i[1],l=Object(a.useState)(JSON.parse(localStorage.getItem("stopList"))),b=Object(y.a)(l,2),d=b[0],j=b[1],f=Object(a.useState)(parseInt(localStorage.getItem("updateTime"),10)),h=Object(y.a)(f,2),p=h[0],g=h[1],x=Object(a.useState)(""),m=Object(y.a)(x,2),v=m[0],k=m[1],S=Object(a.useState)("1+1+CHUK YUEN ESTATE+STAR FERRY"),C=Object(y.a)(S,2),w=C[0],I=C[1],N=Object(a.useState)(localStorage.getItem("geoPermission")),E=Object(y.a)(N,2),T=E[0],R=E[1],P=Object(a.useState)(JSON.parse(localStorage.getItem("geolocation"))||{lat:22.302711,lng:114.177216}),F=Object(y.a)(P,2),B=F[0],q=F[1],A=Object(a.useState)(null),H=Object(y.a)(A,2),G=H[0],Y=H[1],V=Object(a.useState)(JSON.parse(localStorage.getItem("hotRoute"))||{}),$=Object(y.a)(V,2),K=$[0],X=$[1],Z=Object(a.useState)(JSON.parse(localStorage.getItem("savedEtas"))||[]),Q=Object(y.a)(Z,2),tt=Q[0],et=Q[1],nt=Object(a.useState)([]),at=Object(y.a)(nt,2),rt=at[0],ct=at[1],ot=function(){Promise.all([L,z,_].map((function(t){return t.fetchRouteList()}))).then((function(t){var e,n,a={},r=t.reduce((function(t,e){return t.concat(e)})).sort((function(t,e){return t.route<e.route?-1:0}));for(e=0;e<r.length;++e)if(!r[e].imported){var c=J(r[e]);for(n=e+1;n<r.length&&r[e].route===r[n].route;++n)r[n].imported||M(r[e],r[n])&&(c.co.push(r[n].co),c.stops[r[n].co]=r[n].stops,c.bound[r[n].co]=r[n].bound,r[n].imported=!0);a["".concat(c.route,"+").concat(c.serviceType,"+").concat(c.orig.en,"+").concat(c.dest.en)]=c}var o=a;return a={},Object.entries(o).sort((function(t,e){return t[0]<e[0]?-1:1})).forEach((function(t){var e=Object(y.a)(t,2),n=e[0],r=e[1];a[n]=r})),a})).then((function(t){return u(t)})).then((function(){return L.fetchStopList().then((function(t){j(t);var e=Date.now();g(e),localStorage.setItem("updateTime",e)}))}))};Object(a.useEffect)((function(){if(fetch("/hk-independent-bus-eta/schema-version.txt").then((function(t){return t.text()})).then((function(t){var e=!1;r!==t&&(c(t),localStorage.setItem("schemaVersion",t),e=!0),(e=e||null==s||null==d||null==p||p<Date.now()-6048e5)&&ot()})),"granted"===T){var t=navigator.geolocation.watchPosition((function(t){var e=t.coords,n=e.latitude,a=e.longitude;q({lat:n,lng:a})}));Y(t)}return function(){G&&navigator.geolocation.clearWatch(G)}}),[]),Object(a.useEffect)((function(){if("granted"===T){var t=navigator.geolocation.watchPosition((function(t){var e=t.coords,n=e.latitude,a=e.longitude;q({lat:n,lng:a})}));Y(t)}else G&&(navigator.geolocation.clearWatch(G),Y(null))}),[T]),Object(a.useEffect)((function(){ct(U(v,s))}),[v,s]),Object(a.useEffect)((function(){localStorage.setItem("savedEtas",JSON.stringify(tt))}),[tt]),Object(a.useEffect)((function(){localStorage.setItem("stopList",JSON.stringify(d))}),[d]),Object(a.useEffect)((function(){localStorage.setItem("routeList",JSON.stringify(s))}),[s]),Object(a.useEffect)((function(){localStorage.setItem("geolocation",JSON.stringify(B))}),[B]),Object(a.useEffect)((function(){localStorage.setItem("geoPermission",T)}),[T]);return Object(W.jsx)(D.Provider,{value:{routeList:s,stopList:d,setRouteList:u,setStopList:j,updateNewlyFetchedRouteStops:function(t,e){if(0!==e.length){var n={};e.forEach((function(t){n=Object(O.a)(Object(O.a)({},n),t.stopList)})),j(Object(O.a)(Object(O.a)({},d),n)),u((function(n){var a=JSON.parse(JSON.stringify(n));return e.forEach((function(e){return a[t].stops[e.co]=e.routeStops})),a}))}},searchRoute:v,setSearchRoute:k,updateSearchRouteByButton:function(t){switch(t){case"b":k(v.slice(0,-1));break;case"-":k("");break;default:k(v+t)}},selectedRoute:w,updateSelectedRoute:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";I("".concat(t,"/").concat(e)),e&&X((function(n){return n[t+"/"+e]=K[t+"/"+e]?K[t+"/"+e]+1:1,localStorage.setItem("hotRoute",JSON.stringify(n)),n}))},possibleChar:rt,hotRoute:K,geolocation:B,setGeolocation:q,savedEtas:tt,updateSavedEtas:function(t){et((function(e){return e.includes(t)?e.filter((function(e){return e!==t})):e.concat(t)}))},resetUsageRecord:function(){X({}),q({lat:22.302711,lng:114.177216}),et([])},renewDb:ot,schemaVersion:r,updateTime:p,geoPermission:T,setGeoPermission:R},children:t.children})},A=D,U=function(t,e){if(null==e)return[];var n={};return Object.entries(e).forEach((function(e){if(e[0].startsWith(t.toUpperCase())){var a=e[0].slice(t.length,t.length+1);n[a]=isNaN(n[a])?1:n[a]+1}})),Object.entries(n).map((function(t){return t[0]})).filter((function(t){return"+"!==t}))},H=Object(p.a)((function(t){return{toolbar:{"& a":{color:"black",textDecoration:"none"},display:"flex",justifyContent:"space-between",zIndex:2*t.zIndex.drawer},searchRouteInput:{maxWidth:"50px","& input":{textAlign:"center"}}}})),G=Object(S.a)({root:{borderBottom:"none",minHeight:24},indicator:{backgroundColor:"transparent"}})(v.a),Y=Object(S.a)((function(t){return{root:{textTransform:"none",minWidth:36,fontWeight:900,marginRight:t.spacing(0),fontSize:"15px",opacity:1,padding:"6px 6px"},selected:{"& > .MuiTab-wrapper":{color:"#3B3C45",backgroundColor:"#FEFBFA"}},wrapper:{color:"#3B3C45",borderRadius:"30px",padding:"2px 10px 0px 10px"}}}))((function(t){return Object(W.jsx)(k.a,Object(O.a)({disableRipple:!0},t))})),V=function(t){var e=Object(a.useContext)(A),n=e.searchRoute,r=e.setSearchRoute,c=Object(u.j)().path,o=Object(g.a)(),i=o.t,s=o.i18n,b=H(),d=Object(u.h)(),j=Object(u.g)();return Object(W.jsxs)(x.a,{className:b.toolbar,children:[Object(W.jsxs)(l.b,{to:{pathname:"/".concat(s.language,"/search")},children:[Object(W.jsx)(f.a,{variant:"h6",children:"\u9999\u6e2f"}),Object(W.jsx)(f.a,{variant:"subtitle2",children:"\u7368\u7acb\u5df4\u58eb\u9810\u5831"})]}),Object(W.jsx)(m.a,{className:b.searchRouteInput,type:"text",value:n,placeholder:i("\u5df4\u58eb\u7dda"),onChange:function(t){return r(t.target.value)},onFocus:function(t){document.activeElement.blur(),j.replace("/".concat(s.language,"/search"))},disabled:c.includes("route")}),Object(W.jsxs)(G,{value:s.language,onChange:function(t,e){return n=e,j.replace(d.pathname.replace("/"+s.language+"/","/"+n+"/")),void s.changeLanguage(n);var n},children:[Object(W.jsx)(Y,{value:"en",label:"En"}),Object(W.jsx)(Y,{value:"zh",label:"\u7e41"})]})]})},$=n(279),K=function(t,e){var n=t.lat*Math.PI/180,a=e.lat*Math.PI/180,r=(e.lat-t.lat)*Math.PI/180,c=(e.lng-t.lng)*Math.PI/180,o=Math.sin(r/2)*Math.sin(r/2)+Math.cos(n)*Math.cos(a)*Math.sin(c/2)*Math.sin(c/2);return 6371e3*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))},X=n(275),Z=n(276),Q=n(278),tt=function(t){var e=t.name,n=t.location,r=Object(g.a)().t,c=Object(a.useContext)(A),o=c.geoPermission,i=c.geolocation;return"granted"!==o?e:e+" ("+K(n,i).toFixed(0)+r("\u7c73")+")"},et=function(t){var e=t.routeId,n=Object(g.a)(),r=n.t,c=n.i18n,o=Object(a.useContext)(A),i=o.routeList,s=o.stopList,u=e.split("+"),b=Object(y.a)(u,2),j=b[0],f=b[1],h=e.split("/"),p=Object(y.a)(h,2),O=p[0],x=p[1],m=i[O],v=m.co,k=m.stops,S=m.dest,C=m.bound,w=s[k[v[0]]?k[v[0]][parseInt(x,10)]:null],I=Object(a.useState)(null),N=Object(y.a)(I,2),E=N[0],L=N[1],R=nt();Object(a.useEffect)((function(){var t=!0,e=function(){return P({route:j,routeStops:k,seq:parseInt(x,10),bound:C,serviceType:f,co:v}).then((function(e){t&&L(e)}))},n=setInterval((function(){e()}),3e4);return e(),function(){t=!1,clearInterval(n)}}),[]);var z=function(t){if(t){var e=Math.round(T()(t.eta).diff(T()())/60/1e3);return e<1?"- "+r("\u5206\u9418"):Number.isInteger(e)?e+" "+r("\u5206\u9418"):t.remark[c.language]}return""};return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(X.a,{button:!0,component:l.b,to:"/".concat(c.language,"/route/").concat(e),className:R.listItem,children:[Object(W.jsx)(Z.a,{primary:j,className:R.route}),w?Object(W.jsx)(Z.a,{primary:r("\u5f80")+" "+S[c.language],secondary:Object(W.jsx)(tt,{name:w.name[c.language],location:w.location}),className:R.routeDest}):Object(W.jsx)(d.a,{size:15}),Object(W.jsx)(Z.a,{primary:E?z(E[0]):"",secondary:E?z(E[1]):"",className:R.routeEta})]}),Object(W.jsx)(Q.a,{})]})},nt=Object(p.a)((function(t){return{listItem:{padding:"4px 16px"},route:{width:"15%"},routeDest:{width:"65%"},routeEta:{width:"20%"}}})),at=function(){var t=Object(a.useContext)(A),e=t.hotRoute,n=t.savedEtas,r=t.routeList,c=t.stopList,o=t.setStopList,i=t.setRouteList,s=Object(a.useState)(n.concat(Object.entries(e).filter((function(t){var e=Object(y.a)(t,2);e[0];return e[1]>5})).sort((function(t,e){return e[1]-t[1]})).map((function(t){return Object(y.a)(t,1)[0]}))).filter((function(t,e,n){return n.indexOf(t)===e})).slice(0,20)),u=Object(y.a)(s,2),l=u[0],b=u[1],f=Object(a.useState)(!1),h=Object(y.a)(f,2),p=h[0],g=h[1];Object(a.useEffect)((function(){var t=!0,e=JSON.parse(localStorage.getItem("geolocation"));return Object.entries(c).map((function(t){return t.concat(K(t[1].location,e))})).filter((function(t){return t[2]<200})).sort((function(t,e){return t[2]-e[2]})).slice(0,5).forEach((function(e){var n=Object(y.a)(e,1)[0];(function(t,e){return Promise.all([L,z,_].map((function(e){return e.fetchStopEtas(t)}))).then((function(t){return[].concat.apply([],t)})).then((function(t){return Object.entries(e).map((function(e){var n,a=Object(y.a)(e,2),r=a[0],c=a[1],o=Object(I.a)(t);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(c.route===i.route&&c.serviceType===i.serviceType&&c.bound[i.co]===i.bound&&B(c.dest.en,i.dest.en))return r}}catch(s){o.e(s)}finally{o.f()}return null})).filter((function(t){return t}))}))})(n,r).then((function(e){Promise.all(e.map((function(t){return F(r[t]).then((function(e){return[t,e]}))}))).then((function(a){var s=JSON.parse(JSON.stringify(r)),u=JSON.parse(JSON.stringify(c)),l=!1;a.forEach((function(t){var e=Object(y.a)(t,2),n=e[0];e[1].forEach((function(t){s[n].stops[t.co]=t.routeStops,u=Object(O.a)(Object(O.a)({},u),t.stopList)})),l=!0})),l&&(o(u),i(s)),t&&b((function(t){return t.concat(e.map((function(t){return g(!0),t+"/"+Object.entries(s[t].stops).map((function(t){var e=Object(y.a)(t,2);e[0];return e[1].indexOf(n)})).filter((function(t){return t>=0}))[0]}))).filter((function(t,e,n){return n.indexOf(t)===e})).slice(0,20)}))}))}))})),function(){t=!1}}),[]);var x=rt();return Object(W.jsxs)(j.a,{className:x.root,children:[Object(W.jsx)($.a,{className:x.list,children:l.map((function(t){return Object(W.jsx)(et,{routeId:t},t)}))}),p?Object(W.jsx)(W.Fragment,{}):Object(W.jsx)(d.a,{size:20})]})},rt=Object(p.a)((function(t){return{root:{background:"white",height:"calc(100vh - 120px)",overflowY:"scroll",textAlign:"center"}}})),ct=n(97),ot=n(40),it=n(280),st=n(281),ut=n(294),lt=n(254),bt=n(150),dt=n.n(bt),jt=function(t){var e=t.k,n=t.handleClick,a=t.disabled,r=void 0!==a&&a,c=t.className,o=gt(),i=Object(g.a)().t;return Object(W.jsx)(it.a,{size:"large",variant:"contained",className:"".concat(o.button," ").concat(c),onClick:function(){return n(e)},disabled:r,children:"b"===e?Object(W.jsx)(dt.a,{}):"-"===e?Object(W.jsx)("div",{className:o.cancelButton,children:i("\u53d6\u6d88")}):e})},ft=function(){var t=Object(a.useContext)(A),e=t.searchRoute,n=t.updateSearchRouteByButton,r=t.possibleChar;return Object(W.jsx)(st.a,{container:!0,spacing:0,children:"789456123-0b".split("").map((function(t){return Object(W.jsx)(st.a,{item:!0,xs:4,children:Object(W.jsx)(jt,{k:t,handleClick:n,disabled:"b"===t&&""===e||!"b-".includes(t)&&!r.includes(t)||"-"===t&&""===e})},"input-"+t)}))})},ht=function(){var t=Object(a.useContext)(A),e=t.updateSearchRouteByButton,n=t.possibleChar,r=gt();return Object(W.jsx)(st.a,{container:!0,spacing:1,children:n.filter((function(t){return isNaN(t)})).map((function(t){return Object(W.jsx)(st.a,{item:!0,xs:12,children:Object(W.jsx)(jt,{k:t,handleClick:e,className:r.alphabetButton})},"input-"+t)}))})},pt=function(){var t=gt();return Object(W.jsxs)(ut.a,{className:t.boxContainer,padding:0,children:[Object(W.jsx)(ut.a,{className:t.numPadContainer,padding:0,children:Object(W.jsx)(ft,{})}),Object(W.jsx)(ut.a,{className:t.alphabetPadContainer,padding:0,children:Object(W.jsx)(ht,{})})]})},gt=Object(lt.a)((function(t){return{boxContainer:{display:"flex",flexDirection:"row",height:"180px",justifyContent:"space-around"},numPadContainer:{width:"60%"},alphabetPadContainer:{width:"20%",height:"100%",overflowX:"hidden",overflowY:"scroll"},button:{width:"100%",height:"42px",fontSize:"1.2em",borderRadius:"unset"},cancelButton:{fontSize:"0.8em"},alphabetButton:{height:"42px"}}})),Ot=n(282),xt=n(283),mt=n(284),vt=r.a.memo((function(t){var e=t.data,n=t.index,a=t.style,r=Object(g.a)(),c=r.t,o=r.i18n,i=e.routeList[n],s=i[0].split("+").slice(0,2),u=Object(y.a)(s,2),b=u[0],d=u[1],j=kt();return Object(W.jsx)(l.b,{to:"/"+o.language+"/route/"+i[0],children:Object(W.jsx)(Ot.a,{variant:"outlined",style:a,square:!0,children:Object(W.jsx)(xt.a,{children:Object(W.jsxs)(mt.a,{className:j.cardContent,children:[Object(W.jsx)(f.a,{variant:"h5",display:"inline",children:b}),Object(W.jsxs)(f.a,{variant:"caption",children:[" - ",i[1].co.map((function(t){return c(t)})).join("+")]}),Object(W.jsx)("br",{}),Object(W.jsxs)(f.a,{variant:"subtitle2",display:"inline",children:[c("\u5f80")," ",i[1].dest[o.language],"  "]}),Object(W.jsx)(f.a,{variant:"caption",children:d>=2?c("\u7279\u5225\u73ed\u6b21"):"\u3000"})]})})},i[0])})}),ct.b),kt=Object(p.a)((function(t){return{cardContent:{padding:"8px 16px"}}})),St=Object(ot.a)((function(t){return{routeList:t}})),yt=function(){var t=Object(a.useContext)(A),e=t.routeList,n=t.searchRoute,r=Object.entries(e).filter((function(t){var e=Object(y.a)(t,2),a=e[0],r=e[1],c=r.stops,o=r.co;return a.startsWith(n.toUpperCase())&&(null==c[o[0]]||c[o[0]].length>0)})),c=St(r);return Object(W.jsx)(ct.a,{height:330,itemCount:r.length,itemSize:69,width:"100%",itemData:c,children:vt})},Ct=function(){return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(yt,{}),Object(W.jsx)(pt,{})]})},wt=n(62),It=n(140),Nt=n(141),Et=n(143),Tt=n(142),Lt=n(151),Rt=n.n(Lt),zt=n(153),_t=n.n(zt),Pt=function(t){var e=t.center;t.zoom;return Object(wt.a)().flyTo(Jt(e)),Object(W.jsx)(W.Fragment,{})},Ft=function(){var t=Object(a.useContext)(A),e=t.geolocation;return"granted"!==t.geoPermission?null:Object(W.jsx)(It.a,{center:Jt(e),radius:25})},Bt=function(t){var e=t.onClick,n=qt();return Object(W.jsx)("div",{className:"leaflet-bottom leaflet-right",children:Object(W.jsx)("div",{className:"".concat(n.centerControlContainer," leaflet-control leaflet-bar"),onClick:e,children:Object(W.jsx)(_t.a,{className:n.centerControl})})})},Mt=function(t){var e=t.stops,n=t.stopList,r=t.stopIdx,c=t.onMarkerClick,o=Object(a.useContext)(A),i=o.geoPermission,s=o.setGeoPermission,u=o.setGeolocation,l=qt(),b=Object(a.useState)(n[e[r]]?n[e[r]].location:{}),d=Object(y.a)(b,2),j=d[0],f=d[1],h=Object(a.useState)(null),p=Object(y.a)(h,2),g=p[0],O=p[1];Object(a.useEffect)((function(){f(n[e[r]]?n[e[r]].location:n[e[Math.round(e.length/2)]].location)}),[r]);var x=function(t){f(g.getCenter())};return Object(a.useEffect)((function(){if(g)return g.on("dragend",x),function(){g.off("dragend",x)}}),[g]),Object(W.jsx)(ut.a,{className:"".concat(l.mapContainer),children:Object(W.jsxs)(Nt.a,{center:Jt(j),zoom:16,scrollWheelZoom:!1,className:l.mapContainer,whenCreated:O,children:[Object(W.jsx)(Pt,{center:Jt(j),zoom:16}),Object(W.jsx)(Et.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors \xa9 <a href="https://carto.com/attributions">CARTO</a>',url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png"}),e.map((function(t,e,a){return Object(W.jsx)(Rt.a,{position:n[t].location,icon:Object(W.jsx)(Dt,{passed:e<r}),eventHandlers:{click:function(t){c(e)(t,!0,!0)}}},"".concat(t,"-").concat(e))})),e.slice(1).map((function(t,a){return Object(W.jsx)(Tt.a,{positions:[Wt(n[e[a]].location),Wt(n[t].location)],color:"#FF9090"},"".concat(t,"-line"))})),Object(W.jsx)(Ft,{}),Object(W.jsx)(Bt,{onClick:function(){"granted"===i?f(Jt(JSON.parse(localStorage.getItem("geolocation")))):"denied"!==i&&navigator.geolocation.getCurrentPosition((function(t){var e=t.coords,n=e.latitude,a=e.longitude;u({lat:n,lng:a}),f({lat:n,lng:a}),s("granted")}))}})]})})},Jt=function(t){return t&&"number"===typeof t.lat&&isFinite(t.lat)&&"number"===typeof t.lng&&isFinite(t.lng)?t:{lat:22.302711,lng:114.177216}},Wt=function(t){return[t.lat,t.lng]},Dt=function(t){var e=t.passed;return Object(W.jsx)("img",{src:"https://unpkg.com/leaflet@1.0.1/dist/images/marker-icon.png",alt:"",tabIndex:"0",style:{marginLeft:"38px",marginTop:"-14px",width:"25px",height:"41px",zIndex:618,outline:"none",filter:e?"grayscale(100%)":"hue-rotate(130deg)"}})},qt=Object(p.a)((function(t){return{mapContainer:{height:"30vh"},centerControl:{padding:"5px"},centerControlContainer:{background:"white",height:"28px",marginBottom:"20px !important",marginRight:"5px !important"}}})),At=n(253),Ut=n(298),Ht=n(285),Gt=n(286),Yt=n(154),Vt=n.n(Yt),$t=n(155),Kt=n.n($t),Xt=function(t){var e=t.route,n=t.routeStops,r=t.seq,c=t.bound,o=t.serviceType,i=t.co,s=Object(g.a)(),u=s.t,l=s.i18n,b=Object(a.useState)(null),j=Object(y.a)(b,2),h=j[0],p=j[1];if(Object(a.useEffect)((function(){var t=!0,a=function(){P({route:e,routeStops:n,seq:r,bound:c,serviceType:o,co:i}).then((function(e){t&&p(e)}))};a();var s=setInterval((function(){a()}),3e4);return function(){t=!1,clearInterval(s)}}),[]),null==h)return Object(W.jsx)(d.a,{size:20,style:{}});var O=function(t){if(""===t)return"";var e=Math.round(T()(t).diff(T()())/60/1e3);return e<1?"- "+u("\u5206\u9418"):Number.isInteger(e)?e+" "+u("\u5206\u9418"):void 0};return Object(W.jsx)("div",{children:0===h.length?u("\u672a\u6709\u73ed\u6b21\u8cc7\u6599"):h.map((function(t,e){return Object(W.jsxs)(f.a,{variant:"subtitle1",children:[O(t.eta)," - ",t.remark[l.language]?t.remark[l.language]:""," ",u(t.co)]},"route-".concat(e))}))})},Zt=function(t){var e=t.expanded,n=t.setExpanded,r=t.handleChange,c=Object(u.i)(),o=c.id,i=c.panel,s=Object(a.useContext)(A),l=s.routeList,b=s.stopList,d=s.savedEtas,j=s.geoPermission,f=s.updateSavedEtas,h=l[o],p=h.route,O=h.serviceType,x=h.bound,m=h.stops,v=h.co,k=Object(g.a)().i18n,S=Object(a.useRef)([]);Object(a.useEffect)((function(){!1!==e&&S.current[e]&&S.current[e].scrollIntoView({behavior:"smooth",block:"center"})}),[e]),Object(a.useEffect)((function(){!function(){if(parseInt(i,10)&&S.current[parseInt(i,10)])n(parseInt(i,10));else if(j&&m[v[0]]){var t=JSON.parse(localStorage.getItem("geolocation")),e=m[v[0]].map((function(e,n){return[e,n,K(t,b[e].location)]})).sort((function(t,e){return t[2]-e[2]}))[0];if(e){var a=e[1];n(a)}}}()}),[]);var y=ne();return Object(W.jsx)(ut.a,{className:y.boxContainer,children:m[v[0]].map((function(t,n){return Object(W.jsxs)(Qt,{expanded:e===n,onChange:r(n),TransitionProps:{unmountOnExit:!0},ref:function(t){S.current[n]=t},children:[Object(W.jsx)(te,{children:b[t].name[k.language]}),Object(W.jsxs)(ee,{children:[Object(W.jsx)(Xt,{route:p,seq:n,routeStops:m,serviceType:O,bound:x,co:v}),Object(W.jsx)(At.a,{"aria-label":"favourite",onClick:function(){return t="".concat(o,"/").concat(n),f(t);var t},style:{backgroundColor:"transparent"},children:d.includes("".concat(o,"/").concat(n))?Object(W.jsx)(Vt.a,{}):Object(W.jsx)(Kt.a,{})})]})]},"stop-"+n)}))})},Qt=Object(S.a)({root:{border:"1px solid rgba(0, 0, 0, .125)",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"}},expanded:{}})(Ut.a),te=Object(S.a)({root:{backgroundColor:"rgba(0, 0, 0, .03)",borderBottom:"1px solid rgba(0, 0, 0, .125)",marginBottom:-1,minHeight:56,"&$expanded":{minHeight:56}},content:{"&$expanded":{margin:"12px 0"}},expanded:{}})(Ht.a),ee=Object(S.a)((function(t){return{root:{padding:t.spacing(2),justifyContent:"space-between"}}}))(Gt.a),ne=Object(p.a)((function(t){return{boxContainer:{overflowY:"scroll"},loadingContainer:{display:"flex",justifyContent:"center"}}})),ae=function(){var t=Object(u.i)(),e=t.id,n=t.panel,r=Object(a.useState)(parseInt(n,10)),c=Object(y.a)(r,2),o=c[0],i=c[1],s=Object(a.useContext)(A),l=s.routeList,b=s.stopList,j=s.updateNewlyFetchedRouteStops,h=s.updateSelectedRoute,p=l[e],O=p.route,x=p.bound,m=p.stops,v=p.co,k=p.dest,S=Object(g.a)(),C=S.t,w=S.i18n,I=Object(u.g)(),N=function(t){return function(n,a,r){i(!!a&&t),a&&I.replace("/".concat(w.language,"/route/").concat(e,"/").concat(t))}};Object(a.useEffect)((function(){h(e),F({route:O,bound:x,stops:m}).then((function(t){return j(e,t)}))}),[]);var E=re();return null==m[v[0]]?Object(W.jsx)(ut.a,{className:E.loadingContainer,children:Object(W.jsx)(d.a,{size:30})}):0===m[v[0]].length?Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(f.a,{variant:"h5",align:"center",children:C("\u8def\u7dda\u4e0d\u5b58\u5728")})}):Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(f.a,{variant:"subtitle1",align:"center",children:O}),Object(W.jsxs)(f.a,{variant:"caption",align:"center",children:[C("\u5f80")," ",k[w.language]]}),Object(W.jsx)(Mt,{stops:m[v[0]],stopList:b,stopIdx:o,onMarkerClick:N}),Object(W.jsx)(Zt,{expanded:o,setExpanded:i,handleChange:N})]})},re=Object(p.a)((function(t){return{loadingContainer:{display:"flex",justifyContent:"center"}}})),ce=n(287),oe=n(300),ie=n(297),se=n(156),ue=n.n(se),le=n(157),be=n.n(le),de=n(158),je=n.n(de),fe=n(162),he=n.n(fe),pe=n(161),ge=n.n(pe),Oe=n(159),xe=n.n(Oe),me=n(160),ve=n.n(me),ke=n(163),Se=n.n(ke),ye=function(){var t=Object(a.useContext)(A),e=t.schemaVersion,n=t.updateTime,r=t.geoPermission,c=t.setGeoPermission,o=t.renewDb,i=t.resetUsageRecord,s=Object(a.useState)(!1),u=Object(y.a)(s,2),l=u[0],b=u[1],d=Object(a.useState)(!1),f=Object(y.a)(d,2),h=f[0],p=f[1],O=Object(g.a)(),x=O.t,m=O.i18n,v=Ce();return Object(a.useEffect)((function(){b(!1)}),[n]),Object(W.jsxs)(j.a,{className:v.root,children:[Object(W.jsxs)($.a,{children:[Object(W.jsxs)(X.a,{button:!0,onClick:function(){b(!0),o()},children:[Object(W.jsx)(ce.a,{children:Object(W.jsx)(oe.a,{children:Object(W.jsx)(ue.a,{})})}),Object(W.jsx)(Z.a,{primary:x("\u67b6\u69cb\u7248\u672c")+": "+e,secondary:x("\u66f4\u65b0\u6642\u9593")+": "+T()(n).format("YYYY-MM-DD HH:mm:ss")})]}),Object(W.jsxs)(X.a,{button:!0,onClick:function(){"granted"===r?c("closed"):navigator.geolocation.getCurrentPosition((function(t){c("granted")}))},children:[Object(W.jsx)(ce.a,{children:Object(W.jsx)(oe.a,{children:"granted"===r?Object(W.jsx)(be.a,{}):Object(W.jsx)(je.a,{})})}),Object(W.jsx)(Z.a,{primary:x("\u5730\u7406\u4f4d\u7f6e\u5b9a\u4f4d\u529f\u80fd"),secondary:x("granted"===r?"\u958b\u555f":"\u95dc\u9589")})]}),Object(W.jsxs)(X.a,{button:!0,onClick:function(){i()},children:[Object(W.jsx)(ce.a,{children:Object(W.jsx)(oe.a,{children:Object(W.jsx)(xe.a,{})})}),Object(W.jsx)(Z.a,{primary:x("\u4e00\u9375\u6e05\u7a7a\u7528\u6236\u8a18\u9304"),secondary:x("\u5305\u62ec\u9396\u5b9a\u548c\u5e38\u7528\u5831\u6642")})]}),Object(W.jsx)(Q.a,{}),Object(W.jsxs)(X.a,{button:!0,component:"a",href:"https://github.com/chunlaw/hk-independent-bus-eta",target:"_blank",children:[Object(W.jsx)(ce.a,{children:Object(W.jsx)(oe.a,{children:Object(W.jsx)(ve.a,{})})}),Object(W.jsx)(Z.a,{primary:"Source Code",secondary:"GPL-3.0 License"})]}),Object(W.jsxs)(X.a,{children:[Object(W.jsx)(ce.a,{children:Object(W.jsx)(oe.a,{children:Object(W.jsx)(ge.a,{})})}),Object(W.jsx)(Z.a,{primary:x("\u4ea4\u901a\u8cc7\u6599\u4f86\u6e90"),secondary:x("\u8cc7\u6599\u4e00\u7dda\u901a")+"  https://data.gov.hk"})]}),Object(W.jsx)(Q.a,{}),Object(W.jsxs)(X.a,{button:!0,component:"a",href:"https://donate.612fund.hk/".concat(m.language,"/"),target:"_blank",children:[Object(W.jsx)(ce.a,{children:Object(W.jsx)(oe.a,{children:Object(W.jsx)(he.a,{})})}),Object(W.jsx)(Z.a,{primary:x("\u6350\u6b3e\u652f\u6301"),secondary:x("\u8acb\u6350\u6b3e\u5230 612 \u4eba\u9053\u652f\u63f4\u57fa\u91d1")})]}),Object(W.jsxs)(X.a,{button:!0,onClick:function(){navigator.clipboard&&navigator.clipboard.writeText("".concat(window.location.hostname).concat("/hk-independent-bus-eta")).then((function(){p(!0)}))},children:[Object(W.jsx)(ce.a,{children:Object(W.jsx)(oe.a,{children:Object(W.jsx)(Se.a,{})})}),Object(W.jsx)(Z.a,{primary:x("\u8907\u88fd\u61c9\u7528\u7a0b\u5f0f\u93c8\u7d50"),secondary:x("\u7d93\u4e0d\u540c\u5a92\u4ecb\u5206\u4eab\u7d66\u89aa\u53cb")})]})]}),Object(W.jsx)(ie.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:l,message:x("\u8cc7\u6599\u66f4\u65b0\u4e2d")+"..."}),Object(W.jsx)(ie.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:h,autoHideDuration:3e3,onClose:function(t,e){"clickaway"!==e&&p(!1)},message:x("\u93c8\u7d50\u5df2\u8907\u88fd\u5230\u526a\u8cbc\u7c3f")})]})},Ce=Object(p.a)((function(t){return{root:{background:"white",height:"calc(100vh - 120px)"}}})),we=n(288),Ie=n(289),Ne=n(164),Ee=n.n(Ne),Te=n(165),Le=n.n(Te),Re=n(166),ze=n.n(Re),_e=n(167),Pe=n.n(_e),Fe=function(){var t=Object(g.a)(),e=t.t,n=t.i18n,r=Object(u.h)(),c=Object(a.useContext)(A).selectedRoute;return Object(W.jsxs)(we.a,{value:r.pathname,showLabels:!0,children:[Object(W.jsx)(Ie.a,{label:e("\u5e38\u7528"),component:l.b,to:"/".concat(n.language),value:"/".concat(n.language),icon:Object(W.jsx)(Ee.a,{})}),Object(W.jsx)(Ie.a,{label:e("\u641c\u5c0b"),component:l.b,to:"/".concat(n.language,"/search"),value:"/".concat(n.language,"/search"),icon:Object(W.jsx)(Le.a,{})}),Object(W.jsx)(Ie.a,{label:c.split("+")[0],component:l.b,to:"/".concat(n.language,"/route/").concat(c),value:"/".concat(n.language,"/route/").concat(c),icon:Object(W.jsx)(ze.a,{})}),Object(W.jsx)(Ie.a,{label:e("\u8a2d\u5b9a"),component:l.b,to:"/".concat(n.language,"/settings"),value:"/".concat(n.language,"/settings"),icon:Object(W.jsx)(Pe.a,{})})]})},Be=n(168),Me=function(){var t=Object(u.j)().path;return Object(W.jsxs)(u.d,{children:[Object(W.jsx)(u.b,{path:"".concat(t,"/route/:id/:panel?"),children:Object(W.jsx)(ae,{})}),Object(W.jsx)(u.b,{path:"".concat(t,"/settings"),children:Object(W.jsx)(ye,{})}),Object(W.jsx)(u.b,{path:"".concat(t,"/search"),children:Object(W.jsx)(Ct,{})}),Object(W.jsx)(u.b,{path:"".concat(t),children:Object(W.jsx)(at,{})})]})},Je=function(){var t=Object(a.useContext)(A),e=t.routeList,n=t.stopList,r=Object(g.a)().t,c=De();return null==e||null==n?Object(W.jsxs)(b.a,{maxWidth:"xs",disableGutters:!0,className:c.loadingContainer,children:[Object(W.jsx)(d.a,{size:40}),Object(W.jsx)("br",{}),Object(W.jsx)("br",{}),Object(W.jsx)(j.a,{className:c.loadingTextContainer,elevation:0,children:null==n?Object(W.jsx)(Be.a,{date:Date.now()+2e4,renderer:function(t){var e=t.seconds;return t.completed?Object(W.jsxs)(f.a,{variant:"subtitle2",align:"center",children:[r("\u4ecb\u9762\u958b\u555f\u4e2d"),"..."]}):Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(f.a,{variant:"subtitle2",align:"center",children:[r("\u521d\u59cb\u8a2d\u5b9a"),"..."]}),Object(W.jsxs)(f.a,{variant:"subtitle2",align:"center",children:[r("\u6b63\u5728\u66f4\u65b0\u5df4\u58eb\u8def\u7dda\u8cc7\u6599"),"..."]}),Object(W.jsxs)(f.a,{variant:"subtitle2",align:"center",children:[r("\u7d04\u9700"),e,r("\u79d2")]})]})}}):Object(W.jsx)(W.Fragment,{children:r("\u555f\u52d5\u4e2d")})})]}):Object(W.jsx)(i.a,{theme:We,children:Object(W.jsx)(b.a,{maxWidth:"xs",disableGutters:!0,className:c.container,children:Object(W.jsxs)(l.a,{children:[Object(W.jsx)(u.b,{exact:!0,path:"/",children:Object(W.jsx)(u.a,{to:"/zh/"})}),Object(W.jsxs)(u.b,{path:"/:lang",children:[Object(W.jsx)(h.a,{}),Object(W.jsx)(V,{}),Object(W.jsx)(Me,{}),Object(W.jsx)(Fe,{})]})]})})})},We=Object(s.a)({typography:{fontFamily:"Noto Sans TC, Chivo, sans-serif"},palette:{background:{default:"#ffff90"}}}),De=Object(p.a)((function(t){return{container:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100vh"},loadingContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh"},loadingText:{}}})),qe=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ae(t,e){navigator.serviceWorker.register(t).then((function(t){t.onupdatefound=function(){var n=t.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),e&&e.onUpdate&&e.onUpdate(t)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(t)))})}})).catch((function(t){console.error("Error during service worker registration:",t)}))}var Ue=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,303)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,c=e.getLCP,o=e.getTTFB;n(t),a(t),r(t),c(t),o(t)}))},He=n(122),Ge=n(75),Ye=n(169),Ve="en"===window.location.hash.substr(2,2)?"en":"zh";He.a.use(Ge.e).init({resources:Ye,whitelist:["en","zh"],lowerCaseLng:!0,lng:Ve,nsSeparator:!1,keySeparator:!1,debug:!1,interpolation:{escapeValue:!1}});He.a;o.a.render(Object(W.jsx)(r.a.StrictMode,{children:Object(W.jsx)(q,{children:Object(W.jsx)(Je,{})})}),document.getElementById("root")),function(t){if("serviceWorker"in navigator){if(new URL("/hk-independent-bus-eta",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/hk-independent-bus-eta","/service-worker.js");qe?(!function(t,e){fetch(t,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(t){t.unregister().then((function(){window.location.reload()}))})):Ae(t,e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e,t),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Ae(e,t)}))}}(),Ue()}},[[249,1,2]]]);