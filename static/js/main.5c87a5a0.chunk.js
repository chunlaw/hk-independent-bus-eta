(this["webpackJsonphk-independent-bus-eta"]=this["webpackJsonphk-independent-bus-eta"]||[]).push([[0],{170:function(t){t.exports=JSON.parse('{"en":{"translation":{"kmb":"KMB","ctb":"CTB","nwfb":"NWFB","nlb":"NLB","\u521d\u59cb\u8a2d\u5b9a":"Initizaling","\u6b63\u5728\u66f4\u65b0\u5df4\u58eb\u8def\u7dda\u8cc7\u6599":"ppdating route database","\u7d04\u9700":"approx. ","\u555f\u52d5\u4e2d":"Launching","\u4ecb\u9762\u958b\u555f\u4e2d":"Panel opening","\u7c73":"m","\u79d2":"s","\u7531":"From","\u5f80":"To","\u5206\u9418":"min","\u5e38\u7528":"Home","\u641c\u5c0b":"Search","\u8a2d\u5b9a":"Settings","\u53d6\u6d88":"Clear","\u5df4\u58eb\u7dda":"Route","\u67b6\u69cb\u7248\u672c":"Schema Version","\u66f4\u65b0\u6642\u9593":"Last Update time","\u5730\u7406\u4f4d\u7f6e\u5b9a\u4f4d\u529f\u80fd":"Geolocation","\u958b\u555f":"On","\u958b\u555f\u4e2d...":"Switching...","\u95dc\u9589":"Off","\u7121\u6cd5\u7372\u5f97\u5730\u7406\u4f4d\u7f6e\u5b9a\u4f4d\u529f\u80fd\u6b0a\u9650":"Permission denied: Geolocation","\u4e00\u9375\u6e05\u7a7a\u7528\u6236\u8a18\u9304":"Clear Your Usage Records","\u5305\u62ec\u9396\u5b9a\u548c\u5e38\u7528\u5831\u6642":"Includes saved and common use ETA","\u4ea4\u901a\u8cc7\u6599\u4f86\u6e90":"ETA data source","\u8cc7\u6599\u4e00\u7dda\u901a":"DATA.GOV.HK","\u6350\u6b3e\u652f\u6301":"Donate Now","\u8acb\u6350\u6b3e\u5230 612 \u4eba\u9053\u652f\u63f4\u57fa\u91d1":"Please donate to 612 Humanitarian Relief Fund","\u8907\u88fd\u61c9\u7528\u7a0b\u5f0f\u93c8\u7d50":"Copy App URL","\u7d93\u4e0d\u540c\u5a92\u4ecb\u5206\u4eab\u7d66\u89aa\u53cb":"Share it!","\u8eca\u8cbb":"Fee"}},"zh":{"translation":{"kmb":"\u4e5d\u5df4","ctb":"\u57ce\u5df4","nwfb":"\u65b0\u5df4","nlb":"\u65b0\u5927\u5dbc\u5c71\u5df4"}}}')},183:function(t,e,n){},184:function(t,e,n){},252:function(t,e,n){"use strict";n.r(e);var a=n(0),c=n.n(a),o=n(15),r=n.n(o),i=(n(183),n(184),n(300)),s=n(302),u=n(19),l=n(28),b=n(299),d=n(284),j=n(253),h=n(79),p=n(301),f=n(280),g=n(309),O=n(8),m=n(278),x=n(306),v=n(305),k=n(281),w=n(5),S=n(7),y=n(2),C=c.a.createContext(),I=function(t){var e=Object(a.useState)(localStorage.getItem("schemaVersion")),n=Object(S.a)(e,2),c=n[0],o=n[1],r=Object(a.useState)(localStorage.getItem("versionMd5")),i=Object(S.a)(r,2),s=i[0],u=i[1],l=Object(a.useState)(JSON.parse(localStorage.getItem("routeList"))),b=Object(S.a)(l,2),d=b[0],j=b[1],h=Object(a.useState)(JSON.parse(localStorage.getItem("stopList"))),p=Object(S.a)(h,2),f=p[0],g=p[1],O=Object(a.useState)(JSON.parse(localStorage.getItem("stopMap"))),m=Object(S.a)(O,2),x=m[0],v=m[1],k=Object(a.useState)(parseInt(localStorage.getItem("updateTime"),10)),w=Object(S.a)(k,2),I=w[0],N=w[1],T=Object(a.useState)(""),z=Object(S.a)(T,2),L=z[0],M=z[1],R=Object(a.useState)("1+1+CHUK YUEN ESTATE+STAR FERRY"),P=Object(S.a)(R,2),B=P[0],F=P[1],q=Object(a.useState)(localStorage.getItem("geoPermission")),W=Object(S.a)(q,2),A=W[0],J=W[1],D=Object(a.useState)(JSON.parse(localStorage.getItem("geolocation"))||{lat:22.302711,lng:114.177216}),H=Object(S.a)(D,2),_=H[0],U=H[1],G=Object(a.useState)(null),Y=Object(S.a)(G,2),$=Y[0],V=Y[1],K=Object(a.useState)(JSON.parse(localStorage.getItem("hotRoute"))||{}),X=Object(S.a)(K,2),Z=X[0],Q=X[1],tt=Object(a.useState)(JSON.parse(localStorage.getItem("savedEtas"))||[]),et=Object(S.a)(tt,2),nt=et[0],at=et[1],ct=Object(a.useState)([]),ot=Object(S.a)(ct,2),rt=ot[0],it=ot[1],st=function(){fetch("https://hkbus.github.io/hk-bus-crawling/routeFareList.min.json").then((function(t){return t.json()})).then((function(t){var e=t.routeList,n=t.stopList,a=t.stopMap;j(e),g(n),v(a),N(Date.now())}))};Object(a.useEffect)((function(){if(Promise.all(["/hk-independent-bus-eta/schema-version.txt","https://hkbus.github.io/hk-bus-crawling/routeFareList.md5"].map((function(t){return fetch(t).then((function(t){return t.text()}))}))).then((function(t){var e=Object(S.a)(t,2),n=e[0],a=e[1],r=!1;c!==n&&(o(n),localStorage.setItem("schemaVersion",n),r=!0),s!==a&&(u(a),localStorage.setItem("versionMd5",a),r=!0),(r=r||null==d||null==f)&&st()})),"granted"===A){var t=navigator.geolocation.watchPosition((function(t){var e=t.coords,n=e.latitude,a=e.longitude;U({lat:n,lng:a})}));V(t)}return function(){$&&navigator.geolocation.clearWatch($)}}),[]),Object(a.useEffect)((function(){if("granted"===A){var t=navigator.geolocation.watchPosition((function(t){var e=t.coords,n=e.latitude,a=e.longitude;U({lat:n,lng:a})}));V(t)}else $&&(navigator.geolocation.clearWatch($),V(null));localStorage.setItem("geoPermission",A)}),[A]),Object(a.useEffect)((function(){it(E(L,d))}),[L,d]),Object(a.useEffect)((function(){localStorage.setItem("savedEtas",JSON.stringify(nt))}),[nt]),Object(a.useEffect)((function(){localStorage.setItem("stopList",JSON.stringify(f))}),[f]),Object(a.useEffect)((function(){localStorage.setItem("stopMap",JSON.stringify(x))}),[x]),Object(a.useEffect)((function(){localStorage.setItem("routeList",JSON.stringify(d))}),[d]),Object(a.useEffect)((function(){localStorage.setItem("updateTime",I)}),[I]),Object(a.useEffect)((function(){localStorage.setItem("geolocation",JSON.stringify(_))}),[_]);return Object(y.jsx)(C.Provider,{value:{routeList:d,stopList:f,stopMap:x,setRouteList:j,setStopList:g,searchRoute:L,setSearchRoute:M,updateSearchRouteByButton:function(t){switch(t){case"b":M(L.slice(0,-1));break;case"-":M("");break;default:M(L+t)}},selectedRoute:B,updateSelectedRoute:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";F("".concat(t,"/").concat(e)),e&&Q((function(n){return n[t+"/"+e]=Z[t+"/"+e]?Z[t+"/"+e]+1:1,localStorage.setItem("hotRoute",JSON.stringify(n)),n}))},possibleChar:rt,hotRoute:Z,geolocation:_,setGeolocation:U,savedEtas:nt,updateSavedEtas:function(t){at((function(e){return e.includes(t)?e.filter((function(e){return e!==t})):e.concat(t)}))},resetUsageRecord:function(){Q({}),U({lat:22.302711,lng:114.177216}),at([])},renewDb:st,schemaVersion:c,versionMd5:s,updateTime:I,geoPermission:A,setGeoPermission:J},children:t.children})},N=C,E=function(t,e){if(null==e)return[];var n={};return Object.entries(e).forEach((function(e){if(e[0].startsWith(t.toUpperCase())){var a=e[0].slice(t.length,t.length+1);n[a]=isNaN(n[a])?1:n[a]+1}})),Object.entries(n).map((function(t){return t[0]})).filter((function(t){return"+"!==t}))},T=function(t,e){var n=t.lat*Math.PI/180,a=e.lat*Math.PI/180,c=(e.lat-t.lat)*Math.PI/180,o=(e.lng-t.lng)*Math.PI/180,r=Math.sin(c/2)*Math.sin(c/2)+Math.cos(n)*Math.cos(a)*Math.sin(o/2)*Math.sin(o/2);return 6371e3*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)))},z=Object(f.a)((function(t){return{toolbar:{"& a":{color:"black",textDecoration:"none"},display:"flex",justifyContent:"space-between",zIndex:2*t.zIndex.drawer},searchRouteInput:{maxWidth:"50px","& input":{textAlign:"center"}}}})),L=Object(w.a)({root:{borderBottom:"none",minHeight:24},indicator:{backgroundColor:"transparent"}})(v.a),M=Object(w.a)((function(t){return{root:{textTransform:"none",minWidth:36,fontWeight:900,marginRight:t.spacing(0),fontSize:"15px",opacity:1,padding:"6px 6px"},selected:{"& > .MuiTab-wrapper":{color:"#3B3C45",backgroundColor:"#FEFBFA"}},wrapper:{color:"#3B3C45",borderRadius:"30px",padding:"2px 10px 0px 10px"}}}))((function(t){return Object(y.jsx)(k.a,Object(O.a)({disableRipple:!0},t))})),R=function(t){var e=Object(a.useContext)(N),n=e.searchRoute,c=e.setSearchRoute,o=Object(u.j)().path,r=Object(g.a)(),i=r.t,s=r.i18n,b=z(),d=Object(u.h)(),j=Object(u.g)();return Object(y.jsxs)(m.a,{className:b.toolbar,children:[Object(y.jsxs)(l.b,{to:{pathname:"/".concat(s.language,"/search")},children:[Object(y.jsx)(h.a,{variant:"h6",children:"\u9999\u6e2f"}),Object(y.jsx)(h.a,{variant:"subtitle2",children:"\u7368\u7acb\u5df4\u58eb\u9810\u5831"})]}),Object(y.jsx)(x.a,{className:b.searchRouteInput,type:"text",value:n,placeholder:i("\u5df4\u58eb\u7dda"),onChange:function(t){return c(t.target.value)},onFocus:function(t){(function(){var t,e=!1;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e})()&&document.activeElement.blur(),j.replace("/".concat(s.language,"/search"))},disabled:o.includes("route")}),Object(y.jsxs)(L,{value:s.language,onChange:function(t,e){return n=e,j.replace(d.pathname.replace("/"+s.language+"/","/"+n+"/")),void s.changeLanguage(n);var n},children:[Object(y.jsx)(M,{value:"en",label:"En"}),Object(y.jsx)(M,{value:"zh",label:"\u7e41"})]})]})},P=n(286),B=n(282),F=n(283),q=n(285),W=n(124),A=n.n(W),J=n(150),D=n(151),H=n(21),_=n.n(H),U={co:"kmb",fetchEtas:function(t){var e=t.stopId,n=t.route,a=t.seq,c=t.serviceType,o=t.bound;return fetch("https://data.etabus.gov.hk/v1/transport/kmb/eta/".concat(e,"/").concat(n,"/").concat(c),{cache:"no-store"}).then((function(t){return t.json()})).then((function(t){return t.data.filter((function(t){return t.dir===o&&t.seq===a+1})).map((function(t){return{eta:t.eta,remark:{zh:t.rmk_tc,en:t.rmk_en},co:"kmb"}}))}))},fetchStopEtas:function(t){return fetch("https://data.etabus.gov.hk/v1/transport/kmb/stop-eta/".concat(t),{cache:"no-store"}).then((function(t){return t.json()})).then((function(t){return t.data.map((function(t){return{route:t.route,bound:t.dir,seq:t.seq,eta:t.eta?Math.round(_()(t.eta).diff(_()())/60/1e3):t.eta,dest:{zh:t.dest_tc,en:t.dest_en},remark:{zh:t.rmk,en:t.rmk},serviceType:t.service_type,co:"kmb"}}))}))}},G={co:"nwfb",fetchEtas:function(t){var e=t.stopId,n=t.route,a=t.bound;return fetch("https://rt.data.gov.hk//v1/transport/citybus-nwfb/eta/NWFB/".concat(e,"/").concat(n),{cache:"no-store"}).then((function(t){return t.json()})).then((function(t){return t.data.filter((function(t){return t.eta&&t.dir===a})).map((function(t){return{eta:t.eta,remark:{zh:t.rmk_tc,en:t.rmk_en},co:"nwfb"}}))}))},fetchStopEtas:function(t){return fetch("https://rt.data.gov.hk/v1/transport/batch/stop-eta/NWFB/".concat(t),{cache:"no-store"}).then((function(t){return t.json()})).then((function(t){return t.data.map((function(t){return{route:t.route,bound:t.dir,seq:t.seq,eta:t.eta?Math.round(_()(t.eta).diff(_()())/60/1e3):t.eta,dest:{en:t.dest.replace("/","\uff0f")},remark:{en:t.rmk},serviceType:1,co:"nwfb"}}))}))}},Y={co:"ctb",fetchEtas:function(t){var e=t.stopId,n=t.route,a=t.bound;return fetch("https://rt.data.gov.hk//v1/transport/citybus-nwfb/eta/CTB/".concat(e,"/").concat(n),{cache:"no-store"}).then((function(t){return t.json()})).then((function(t){return t.data.filter((function(t){return t.eta&&t.dir===a})).map((function(t){return{eta:t.eta,remark:{zh:t.rmk_tc,en:t.rmk_en},co:"ctb"}}))}))},fetchStopEtas:function(t){return fetch("https://rt.data.gov.hk/v1/transport/batch/stop-eta/CTB/".concat(t),{cache:"no-store"}).then((function(t){return t.json()})).then((function(t){return t.data.map((function(t){return{route:t.route,bound:t.dir,seq:t.seq,eta:t.eta?Math.round(_()(t.eta).diff(_()())/60/1e3):t.eta,dest:{en:t.dest.replace("/","\uff0f")},remark:{en:t.rmk},serviceType:1,co:"ctb"}}))}))}},$={co:"nlb",fetchEtas:function(t){var e=t.stopId,n=t.nlbId;return fetch("https://rt.data.gov.hk/v1/transport/nlb/stop.php?action=estimatedArrivals",{body:JSON.stringify({routeId:n,stopId:e,language:"zh"}),headers:{"Content-Type":"text/plain"},method:"POST",cache:"no-store"}).then((function(t){return t.json()})).then((function(t){var e=t.estimatedArrivals;return e?e.filter((function(t){return t.estimatedArrivalTime})).map((function(t){return{eta:t.estimatedArrivalTime,remark:{zh:"",en:""},co:"nlb"}})):[]}))},fetchStopEtas:function(t){return fetch("https://rt.data.gov.hk/v1/transport/batch/stop-eta/NLB/".concat(t),{cache:"no-store"}).then((function(t){if(t.ok)return t.json();throw new Error("Stop not exist")})).then((function(t){return t.data.map((function(t){return{route:t.route,eta:t.eta?Math.round(_()(t.eta).diff(_()())/60/1e3):t.eta,dest:{en:t.dest},remark:{en:t.rmk},co:"nlb"}}))})).catch((function(){return[]}))}},V=function(){var t=Object(D.a)(A.a.mark((function t(e){var n,a,c,o,r,i,s,u,l,b,d;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.route,a=e.routeStops,c=e.bound,o=e.seq,r=e.serviceType,i=e.co,s=e.nlbId,u=[],l=Object(J.a)(i),t.prev=3,l.s();case 5:if((b=l.n()).done){t.next=39;break}if("kmb"!==(d=b.value)||!a.kmb){t.next=15;break}return t.t0=u,t.next=11,U.fetchEtas({route:n,stopId:a.kmb[o],seq:o+1===a.kmb.length?1e3:o,serviceType:r,bound:c[d]});case 11:t.t1=t.sent,u=t.t0.concat.call(t.t0,t.t1),t.next=37;break;case 15:if("ctb"!==d||!a.ctb){t.next=23;break}return t.t2=u,t.next=19,Y.fetchEtas({stopId:a.ctb[o],route:n,bound:c[d]});case 19:t.t3=t.sent,u=t.t2.concat.call(t.t2,t.t3),t.next=37;break;case 23:if("nwfb"!==d||!a.nwfb){t.next=31;break}return t.t4=u,t.next=27,G.fetchEtas({stopId:a.nwfb[o],route:n,bound:c[d]});case 27:t.t5=t.sent,u=t.t4.concat.call(t.t4,t.t5),t.next=37;break;case 31:if("nlb"!==d||!a.nlb){t.next=37;break}return t.t6=u,t.next=35,$.fetchEtas({stopId:a.nlb[o],nlbId:s});case 35:t.t7=t.sent,u=t.t6.concat.call(t.t6,t.t7);case 37:t.next=5;break;case 39:t.next=44;break;case 41:t.prev=41,t.t8=t.catch(3),l.e(t.t8);case 44:return t.prev=44,l.f(),t.finish(44);case 47:return t.abrupt("return",u.sort((function(t,e){return""===t.eta?1:""===e.eta||t.eta<e.eta?-1:1})));case 48:case"end":return t.stop()}}),t,null,[[3,41,44,47]])})));return function(e){return t.apply(this,arguments)}}(),K=function(t){var e=t.name,n=t.location,c=t.fares,o=t.faresHoliday,r=t.seq,i=Object(g.a)().t,s=Object(a.useContext)(N),u=s.geoPermission,l=s.geolocation,b=[c&&c[r]?"$"+c[r]:"",o&&o[r]?"$"+o[r]:""].filter((function(t){return t})).join(", ");return"granted"!==u?e+"\u3000"+(b?"("+b+")":""):e+" - "+T(n,l).toFixed(0)+i("\u7c73")+"\u3000"+(b?"("+b+")":"")},X=function(t){var e=t.routeId,n=Object(g.a)(),c=n.t,o=n.i18n,r=Object(a.useContext)(N),i=r.routeList,s=r.stopList,u=e.split("+"),b=Object(S.a)(u,2),j=b[0],h=b[1],p=e.split("/"),f=Object(S.a)(p,2),O=f[0],m=f[1],x=i[O],v=x.co,k=x.stops,w=x.dest,C=x.bound,I=x.nlbId,E=x.fares,T=x.faresHoliday,z=s[k[v[0]]?k[v[0]][parseInt(m,10)]:null],L=Object(a.useState)(null),M=Object(S.a)(L,2),R=M[0],P=M[1],W=Z();Object(a.useEffect)((function(){var t=!0,e=function(){return V({route:j,routeStops:k,seq:parseInt(m,10),bound:C,serviceType:h,co:v,nlbId:I}).then((function(e){t&&P(e)}))},n=setInterval((function(){e()}),3e4);return e(),function(){t=!1,clearInterval(n)}}),[]);var A=function(t){if(t){var e=Math.round(_()(t.eta).diff(_()())/60/1e3);return e<1?"- "+c("\u5206\u9418"):Number.isInteger(e)?e+" "+c("\u5206\u9418"):t.remark[o.language]}return""};return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)(B.a,{button:!0,component:l.b,to:"/".concat(o.language,"/route/").concat(e),className:W.listItem,children:[Object(y.jsx)(F.a,{primary:j,className:W.route}),z?Object(y.jsx)(F.a,{primary:c("\u5f80")+" "+w[o.language],secondary:Object(y.jsx)(K,{name:z.name[o.language],location:z.location,fares:E,faresHoliday:T,seq:parseInt(m,10)}),className:W.routeDest}):Object(y.jsx)(d.a,{size:15}),Object(y.jsx)(F.a,{primary:R?A(R[0]):"",secondary:R?A(R[1]):"",className:W.routeEta})]}),Object(y.jsx)(q.a,{})]})},Z=Object(f.a)((function(t){return{listItem:{padding:"4px 16px"},route:{width:"15%"},routeDest:{width:"65%"},routeEta:{width:"20%"}}})),Q=function(){var t=Object(a.useContext)(N),e=t.hotRoute,n=t.savedEtas,c=t.routeList,o=t.stopList,r=Object(a.useState)(n.concat(Object.entries(e).filter((function(t){var e=Object(S.a)(t,2);e[0];return e[1]>5})).sort((function(t,e){return e[1]-t[1]})).map((function(t){return Object(S.a)(t,1)[0]}))).filter((function(t,e,n){return n.indexOf(t)===e})).slice(0,20)),i=Object(S.a)(r,2),s=i[0],u=i[1],l=Object(a.useState)(!1),b=Object(S.a)(l,2),h=b[0],p=b[1];Object(a.useEffect)((function(){var t=!0,e=JSON.parse(localStorage.getItem("geolocation"));return Object.entries(o).map((function(t){return t.concat(T(t[1].location,e))})).filter((function(t){return t[2]<1e3})).sort((function(t,e){return t[2]-e[2]})).slice(0,5).forEach((function(e){var n=Object(S.a)(e,1)[0],a=[];Object.entries(c).forEach((function(t){var e=Object(S.a)(t,2),c=e[0],o=e[1];["kmb","nwfb","ctb"].forEach((function(t){o.stops[t]&&o.stops[t].includes(n)&&a.push(c+"/"+o.stops[t].indexOf(n))}))})),t&&u((function(t){return t.concat(a.map((function(t){return p(!0),t}))).filter((function(t,e,n){return n.indexOf(t)===e})).slice(0,20)}))})),function(){t=!1}}),[]);var f=tt();return Object(y.jsxs)(j.a,{className:f.root,children:[Object(y.jsx)(P.a,{className:f.list,children:s.map((function(t){return Object(y.jsx)(X,{routeId:t},t)}))}),h?Object(y.jsx)(y.Fragment,{}):Object(y.jsx)(d.a,{size:20})]})},tt=Object(f.a)((function(t){return{root:{background:"white",height:"calc(100vh - 120px)",overflowY:"scroll",textAlign:"center"}}})),et=n(100),nt=n(46),at=n(287),ct=n(288),ot=n(303),rt=n(257),it=n(152),st=n.n(it),ut=function(t){var e=t.k,n=t.handleClick,a=t.disabled,c=void 0!==a&&a,o=t.className,r=jt(),i=Object(g.a)().t;return Object(y.jsx)(at.a,{size:"large",variant:"contained",className:"".concat(r.button," ").concat(o),onClick:function(){return n(e)},disabled:c,children:"b"===e?Object(y.jsx)(st.a,{}):"-"===e?Object(y.jsx)("div",{className:r.cancelButton,children:i("\u53d6\u6d88")}):e})},lt=function(){var t=Object(a.useContext)(N),e=t.searchRoute,n=t.updateSearchRouteByButton,c=t.possibleChar;return Object(y.jsx)(ct.a,{container:!0,spacing:0,children:"789456123-0b".split("").map((function(t){return Object(y.jsx)(ct.a,{item:!0,xs:4,children:Object(y.jsx)(ut,{k:t,handleClick:n,disabled:"b"===t&&""===e||!"b-".includes(t)&&!c.includes(t)||"-"===t&&""===e})},"input-"+t)}))})},bt=function(){var t=Object(a.useContext)(N),e=t.updateSearchRouteByButton,n=t.possibleChar,c=jt();return Object(y.jsx)(ct.a,{container:!0,spacing:1,children:n.filter((function(t){return isNaN(t)})).map((function(t){return Object(y.jsx)(ct.a,{item:!0,xs:12,children:Object(y.jsx)(ut,{k:t,handleClick:e,className:c.alphabetButton})},"input-"+t)}))})},dt=function(){var t=jt();return Object(y.jsxs)(ot.a,{className:t.boxContainer,padding:0,children:[Object(y.jsx)(ot.a,{className:t.numPadContainer,padding:0,children:Object(y.jsx)(lt,{})}),Object(y.jsx)(ot.a,{className:t.alphabetPadContainer,padding:0,children:Object(y.jsx)(bt,{})})]})},jt=Object(rt.a)((function(t){return{boxContainer:{display:"flex",flexDirection:"row",height:"calc(100vh - 330px - 112px)",paddingTop:"calc(50vh - 165px - 56px - 88px)",paddingBottom:"calc(50vh - 165px - 56px - 88px)",justifyContent:"space-around"},numPadContainer:{width:"60%"},alphabetPadContainer:{width:"20%",height:"176px",overflowX:"hidden",overflowY:"scroll"},button:{width:"100%",height:"44px",fontSize:"1.2em",borderRadius:"unset"},cancelButton:{fontSize:"0.8em"},alphabetButton:{height:"42px"}}})),ht=n(289),pt=n(290),ft=n(291),gt=function(t){var e=t.route,n=Object(g.a)(),a=n.t,c=n.i18n;return Object(y.jsx)(y.Fragment,{children:e.nlbId?Object(y.jsxs)(h.a,{variant:"subtitle2",display:"inline",children:[a("\u5f80")," ",e.dest[c.language]," ",a("\u7531")+" "+e.orig[c.language]]}):Object(y.jsxs)(h.a,{variant:"subtitle2",display:"inline",children:[a("\u5f80")," ",e.dest[c.language]]})})},Ot=c.a.memo((function(t){var e=t.data,n=t.index,a=t.style,c=Object(g.a)(),o=c.t,r=c.i18n,i=e.routeList[n],s=i[0].split("+").slice(0,2),u=Object(S.a)(s,2),b=u[0],d=u[1],j=mt();return Object(y.jsx)(l.b,{to:"/"+r.language+"/route/"+i[0],children:Object(y.jsx)(ht.a,{variant:"outlined",style:a,square:!0,children:Object(y.jsx)(pt.a,{children:Object(y.jsxs)(ft.a,{className:j.cardContent,children:[Object(y.jsx)(h.a,{variant:"h5",display:"inline",children:b}),Object(y.jsxs)(h.a,{variant:"caption",children:[" - ",i[1].co.map((function(t){return o(t)})).join("+")]}),Object(y.jsx)("br",{}),Object(y.jsx)(gt,{route:i[1]}),Object(y.jsx)(h.a,{variant:"caption",children:d>=2?o("\u7279\u5225\u73ed\u6b21"):"\u3000"})]})})},i[0])})}),et.b),mt=Object(f.a)((function(t){return{cardContent:{padding:"8px 16px"}}})),xt=Object(nt.a)((function(t){return{routeList:t}})),vt=function(){var t=Object(a.useContext)(N),e=t.routeList,n=t.searchRoute,c=Object.entries(e).filter((function(t){var e=Object(S.a)(t,2),a=e[0],c=e[1],o=c.stops,r=c.co;return a.startsWith(n.toUpperCase())&&(null==o[r[0]]||o[r[0]].length>0)})),o=xt(c);return Object(y.jsx)(et.a,{height:330,itemCount:c.length,itemSize:69,width:"100%",itemData:o,children:Ot})},kt=function(){return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(vt,{}),Object(y.jsx)(dt,{})]})},wt=n(66),St=n(141),yt=n(142),Ct=n(144),It=n(143),Nt=n(153),Et=n.n(Nt),Tt=n(155),zt=n.n(Tt),Lt=function(t){var e=t.center;t.zoom;return Object(wt.a)().flyTo(Bt(e)),Object(y.jsx)(y.Fragment,{})},Mt=function(){var t=Object(a.useContext)(N),e=t.geolocation;return"granted"!==t.geoPermission?null:Object(y.jsx)(St.a,{center:Bt(e),radius:25})},Rt=function(t){var e=t.onClick,n=Wt();return Object(y.jsx)("div",{className:"leaflet-bottom leaflet-right",children:Object(y.jsx)("div",{className:"".concat(n.centerControlContainer," leaflet-control leaflet-bar"),onClick:e,children:Object(y.jsx)(zt.a,{className:n.centerControl})})})},Pt=function(t){var e=t.stops,n=t.stopIdx,c=t.onMarkerClick,o=Object(a.useContext)(N),r=o.stopList,i=o.geoPermission,s=o.setGeoPermission,u=o.setGeolocation,l=Wt(),b=Object(a.useState)(r[e[n]]?r[e[n]].location:{}),d=Object(S.a)(b,2),j=d[0],h=d[1],p=Object(a.useState)(null),f=Object(S.a)(p,2),g=f[0],O=f[1];Object(a.useEffect)((function(){h(r[e[n]]?r[e[n]].location:r[e[Math.round(e.length/2)]].location)}),[n]);var m=function(t){h(g.getCenter())};return Object(a.useEffect)((function(){if(g)return g.on("dragend",m),function(){g.off("dragend",m)}}),[g]),Object(y.jsx)(ot.a,{className:"".concat(l.mapContainer),children:Object(y.jsxs)(yt.a,{center:Bt(j),zoom:16,scrollWheelZoom:!1,className:l.mapContainer,whenCreated:O,children:[Object(y.jsx)(Lt,{center:Bt(j),zoom:16}),Object(y.jsx)(Ct.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors \xa9 <a href="https://carto.com/attributions">CARTO</a>',url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png"}),e.map((function(t,e,a){return Object(y.jsx)(Et.a,{position:r[t].location,icon:Object(y.jsx)(qt,{active:e===n,passed:e<n}),eventHandlers:{click:function(t){c(e)(t,!0,!0)}}},"".concat(t,"-").concat(e))})),e.slice(1).map((function(t,n){return Object(y.jsx)(It.a,{positions:[Ft(r[e[n]].location),Ft(r[t].location)],color:"#FF9090"},"".concat(t,"-line"))})),Object(y.jsx)(Mt,{}),Object(y.jsx)(Rt,{onClick:function(){"granted"===i?h(Bt(JSON.parse(localStorage.getItem("geolocation")))):"denied"!==i&&navigator.geolocation.getCurrentPosition((function(t){var e=t.coords,n=e.latitude,a=e.longitude;u({lat:n,lng:a}),h({lat:n,lng:a}),s("granted")}))}})]})})},Bt=function(t){return t&&"number"===typeof t.lat&&isFinite(t.lat)&&"number"===typeof t.lng&&isFinite(t.lng)?t:{lat:22.302711,lng:114.177216}},Ft=function(t){return[t.lat,t.lng]},qt=function(t){var e=t.active,n=t.passed,a=Wt();return Object(y.jsx)("img",{src:"https://unpkg.com/leaflet@1.0.1/dist/images/marker-icon.png",alt:"",tabIndex:"0",className:"".concat(a.marker," ").concat(e?a.active:""),style:{filter:n?"grayscale(100%)":"hue-rotate(130deg)"}})},Wt=Object(f.a)((function(t){return{mapContainer:{height:"30vh"},centerControl:{padding:"5px"},centerControlContainer:{background:"white",height:"28px",marginBottom:"20px !important",marginRight:"5px !important"},marker:{marginLeft:"38px",marginTop:"-14px",width:"25px",height:"41px",zIndex:618,outline:"none"},active:{animation:"$blinker 2s linear infinite"},"@keyframes blinker":{"50%":{opacity:.3}}}})),At=n(256),Jt=n(308),Dt=n(292),Ht=n(293),_t=n(156),Ut=n.n(_t),Gt=n(157),Yt=n.n(Gt),$t=function(t){var e=t.route,n=t.routeStops,c=t.seq,o=t.bound,r=t.serviceType,i=t.co,s=t.nlbId,u=Object(g.a)(),l=u.t,b=u.i18n,j=Object(a.useState)(null),p=Object(S.a)(j,2),f=p[0],O=p[1];if(Object(a.useEffect)((function(){var t=!0,a=function(){V({route:e,routeStops:n,seq:c,bound:o,serviceType:r,co:i,nlbId:s}).then((function(e){t&&O(e)}))};a();var u=setInterval((function(){a()}),3e4);return function(){t=!1,clearInterval(u)}}),[]),null==f)return Object(y.jsx)(d.a,{size:20,style:{}});var m=function(t){if(""===t)return"";var e=Math.round(_()(t).diff(_()())/60/1e3);return e<1?"- "+l("\u5206\u9418"):Number.isInteger(e)?e+" "+l("\u5206\u9418"):void 0};return Object(y.jsx)("div",{children:0===f.length?l("\u672a\u6709\u73ed\u6b21\u8cc7\u6599"):f.map((function(t,e){return Object(y.jsxs)(h.a,{variant:"subtitle1",children:[m(t.eta)," - ",t.remark[b.language]?t.remark[b.language]:""," ",l(t.co)]},"route-".concat(e))}))})},Vt=function(t){var e=t.expanded,n=t.setExpanded,c=t.handleChange,o=Object(u.i)(),r=o.id,i=o.panel,s=Object(a.useContext)(N),l=s.routeList,b=s.stopList,d=s.savedEtas,j=s.geoPermission,p=s.updateSavedEtas,f=l[r],O=f.route,m=f.serviceType,x=f.bound,v=f.stops,k=f.co,w=f.fares,S=f.faresHoliday,C=f.nlbId,I=Object(g.a)(),E=I.t,z=I.i18n,L=Object(a.useRef)([]);Object(a.useEffect)((function(){!1!==e&&L.current[e]&&L.current[e].scrollIntoView({behavior:"smooth",block:"center"})}),[e]),Object(a.useEffect)((function(){!function(){if(parseInt(i,10)&&L.current[parseInt(i,10)])n(parseInt(i,10));else if("granted"===j){var t=JSON.parse(localStorage.getItem("geolocation")),e=v[k[0]].map((function(e,n){return[e,n,T(t,b[e].location)]})).sort((function(t,e){return t[2]-e[2]}))[0];if(e){var a=e[1];n(a)}}}()}),[]);var M=Qt();return Object(y.jsx)(ot.a,{className:M.boxContainer,children:v[k[0]].map((function(t,n){return Object(y.jsxs)(Kt,{expanded:e===n,onChange:c(n),TransitionProps:{unmountOnExit:!0},ref:function(t){L.current[n]=t},children:[Object(y.jsxs)(Xt,{children:[Object(y.jsx)(h.a,{variant:"body1",children:b[t].name[z.language]}),Object(y.jsxs)(h.a,{variant:"caption",children:[w&&w[n]?E("\u8eca\u8cbb")+": $"+w[n]:"",S&&S[n]?"\u3000\u3000\u3000\u3000"+E("\u5047\u65e5\u8eca\u8cbb")+": $"+S[n]:""]})]}),Object(y.jsxs)(Zt,{children:[Object(y.jsx)($t,{route:O,seq:n,routeStops:v,serviceType:m,bound:x,co:k,nlbId:C}),Object(y.jsx)(At.a,{"aria-label":"favourite",onClick:function(){return t="".concat(r,"/").concat(n),p(t);var t},style:{backgroundColor:"transparent"},children:d.includes("".concat(r,"/").concat(n))?Object(y.jsx)(Ut.a,{}):Object(y.jsx)(Yt.a,{})})]})]},"stop-"+n)}))})},Kt=Object(w.a)({root:{border:"1px solid rgba(0, 0, 0, .125)",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"}},expanded:{}})(Jt.a),Xt=Object(w.a)({root:{backgroundColor:"rgba(0, 0, 0, .03)",borderBottom:"1px solid rgba(0, 0, 0, .125)",marginBottom:-1,minHeight:44,"&$expanded":{minHeight:44}},content:{"&$expanded":{margin:"8px 0"},margin:"8px 0",flexDirection:"column"},expanded:{}})(Dt.a),Zt=Object(w.a)((function(t){return{root:{padding:t.spacing(2),paddingTop:t.spacing(1),paddingBottom:t.spacing(1),justifyContent:"space-between"}}}))(Ht.a),Qt=Object(f.a)((function(t){return{boxContainer:{overflowY:"scroll"},loadingContainer:{display:"flex",justifyContent:"center"}}})),te=n(304),ee=n(294),ne=n(295),ae=Object(f.a)((function(t){return{dialog:{"& .MuiPaper-root":{width:"100%",marginTop:"90px",height:"calc(100vh - 100px)"}},title:{background:"#ffff90"}}})),ce=function(t){var e=t.open,n=t.stops,c=t.handleClose,o=Object(a.useContext)(N),r=o.routeList,i=o.stopList,s=Object(g.a)().i18n,u=Object(a.useState)([]),l=Object(S.a)(u,2),b=l[0],d=l[1],j=ae();return Object(a.useEffect)((function(){if(void 0!==n){var t=[];Object.entries(r).forEach((function(e){var a=Object(S.a)(e,2),c=a[0],o=a[1];n.some((function(e){var n=Object(S.a)(e,2),a=n[0],r=n[1];return!(!o.stops[a]||!o.stops[a].includes(r))&&(t.push(c+"/"+o.stops[a].indexOf(r)),!0)}))})),d(t)}else d([])}),[n]),Object(y.jsxs)(te.a,{open:e,onClose:c,className:j.dialog,children:[Object(y.jsx)(ee.a,{className:j.title,children:i[n[0][1]].name[s.language]}),Object(y.jsx)(ne.a,{children:Object(y.jsx)(P.a,{children:b.map((function(t){return Object(y.jsx)(X,{routeId:t},t)}))})})]})},oe=function(){var t=Object(u.i)(),e=t.id,n=t.panel,c=Object(a.useContext)(N),o=c.routeList,r=c.stopMap,i=c.updateSelectedRoute,s=o[e],l=s.route,b=s.stops,j=s.co,p=s.orig,f=s.dest,O=s.nlbId,m=Object(a.useState)(parseInt(n,10)),x=Object(S.a)(m,2),v=x[0],k=x[1],w=Object(a.useState)(!1),C=Object(S.a)(w,2),I=C[0],E=C[1],T=Object(a.useState)([[j[0],b[j[0]][0]]].concat(r[b[j[0]][0]]||[])),z=Object(S.a)(T,2),L=z[0],M=z[1],R=Object(g.a)(),P=R.t,B=R.i18n,F=Object(u.g)(),q=function(t){return function(n,a,c){k(!!a&&t),M([[j[0],b[j[0]][t]]].concat(r[b[j[0]][t]]||[])),a&&F.replace("/".concat(B.language,"/route/").concat(e,"/").concat(t))}};Object(a.useEffect)((function(){E(!1),n&&k(parseInt(n,10))}),[l]),Object(a.useEffect)((function(){i(e)}),[]);var W=re();return null==b[j[0]]?Object(y.jsx)(ot.a,{className:W.loadingContainer,children:Object(y.jsx)(d.a,{size:30})}):0===b[j[0]].length?Object(y.jsx)(y.Fragment,{children:Object(y.jsx)(h.a,{variant:"h5",align:"center",children:P("\u8def\u7dda\u4e0d\u5b58\u5728")})}):Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(h.a,{variant:"subtitle1",align:"center",children:l}),Object(y.jsxs)(h.a,{variant:"caption",align:"center",children:[P("\u5f80")," ",f[B.language]," ",O?P("\u7531")+" "+p[B.language]:""]}),Object(y.jsx)(Pt,{stops:b[j[0]],stopIdx:v,onMarkerClick:function(t){return v===t&&E(!0),q(t)}}),Object(y.jsx)(Vt,{expanded:v,setExpanded:k,handleChange:q}),Object(y.jsx)(ce,{open:I,stops:L,handleClose:function(){E(!1)}})]})},re=Object(f.a)((function(t){return{loadingContainer:{display:"flex",justifyContent:"center"}}})),ie=n(296),se=n(310),ue=n(307),le=n(158),be=n.n(le),de=n(159),je=n.n(de),he=n(160),pe=n.n(he),fe=n(164),ge=n.n(fe),Oe=n(163),me=n.n(Oe),xe=n(161),ve=n.n(xe),ke=n(162),we=n.n(ke),Se=n(165),ye=n.n(Se),Ce=function(){var t=Object(a.useContext)(N),e=t.schemaVersion,n=t.versionMd5,c=t.updateTime,o=t.geoPermission,r=t.setGeoPermission,i=t.renewDb,s=t.resetUsageRecord,u=Object(a.useState)(!1),l=Object(S.a)(u,2),b=l[0],d=l[1],h=Object(a.useState)(!1),p=Object(S.a)(h,2),f=p[0],O=p[1],m=Object(a.useState)(!1),x=Object(S.a)(m,2),v=x[0],k=x[1],w=Object(g.a)(),C=w.t,I=w.i18n,E=Ie();return Object(a.useEffect)((function(){d(!1)}),[c]),Object(y.jsxs)(j.a,{className:E.root,children:[Object(y.jsxs)(P.a,{children:[Object(y.jsxs)(B.a,{button:!0,onClick:function(){d(!0),i()},children:[Object(y.jsx)(ie.a,{children:Object(y.jsx)(se.a,{children:Object(y.jsx)(be.a,{})})}),Object(y.jsx)(F.a,{primary:C("\u67b6\u69cb\u7248\u672c")+": "+e+" - "+n.substr(0,6),secondary:C("\u66f4\u65b0\u6642\u9593")+": "+_()(c).format("YYYY-MM-DD HH:mm:ss")})]}),Object(y.jsxs)(B.a,{button:!0,onClick:function(){"granted"===o?r("closed"):(r("opening"),navigator.geolocation.getCurrentPosition((function(t){r("granted")}),(function(){r("denied"),O(!0)})))},children:[Object(y.jsx)(ie.a,{children:Object(y.jsx)(se.a,{children:"granted"===o?Object(y.jsx)(je.a,{}):Object(y.jsx)(pe.a,{})})}),Object(y.jsx)(F.a,{primary:C("\u5730\u7406\u4f4d\u7f6e\u5b9a\u4f4d\u529f\u80fd"),secondary:C("granted"===o?"\u958b\u555f":"opening"===o?"\u958b\u555f\u4e2d...":"\u95dc\u9589")})]}),Object(y.jsxs)(B.a,{button:!0,onClick:function(){s()},children:[Object(y.jsx)(ie.a,{children:Object(y.jsx)(se.a,{children:Object(y.jsx)(ve.a,{})})}),Object(y.jsx)(F.a,{primary:C("\u4e00\u9375\u6e05\u7a7a\u7528\u6236\u8a18\u9304"),secondary:C("\u5305\u62ec\u9396\u5b9a\u548c\u5e38\u7528\u5831\u6642")})]}),Object(y.jsx)(q.a,{}),Object(y.jsxs)(B.a,{button:!0,component:"a",href:"https://github.com/chunlaw/hk-independent-bus-eta",target:"_blank",children:[Object(y.jsx)(ie.a,{children:Object(y.jsx)(se.a,{children:Object(y.jsx)(we.a,{})})}),Object(y.jsx)(F.a,{primary:"Source Code",secondary:"GPL-3.0 License"})]}),Object(y.jsxs)(B.a,{children:[Object(y.jsx)(ie.a,{children:Object(y.jsx)(se.a,{children:Object(y.jsx)(me.a,{})})}),Object(y.jsx)(F.a,{primary:C("\u4ea4\u901a\u8cc7\u6599\u4f86\u6e90"),secondary:C("\u8cc7\u6599\u4e00\u7dda\u901a")+"  https://data.gov.hk"})]}),Object(y.jsx)(q.a,{}),Object(y.jsxs)(B.a,{button:!0,component:"a",href:"https://donate.612fund.hk/".concat(I.language,"/"),target:"_blank",children:[Object(y.jsx)(ie.a,{children:Object(y.jsx)(se.a,{children:Object(y.jsx)(ge.a,{})})}),Object(y.jsx)(F.a,{primary:C("\u6350\u6b3e\u652f\u6301"),secondary:C("\u8acb\u6350\u6b3e\u5230 612 \u4eba\u9053\u652f\u63f4\u57fa\u91d1")})]}),Object(y.jsxs)(B.a,{button:!0,onClick:function(){navigator.clipboard&&navigator.clipboard.writeText("".concat(window.location.hostname).concat("/hk-independent-bus-eta")).then((function(){k(!0)}))},children:[Object(y.jsx)(ie.a,{children:Object(y.jsx)(se.a,{children:Object(y.jsx)(ye.a,{})})}),Object(y.jsx)(F.a,{primary:C("\u8907\u88fd\u61c9\u7528\u7a0b\u5f0f\u93c8\u7d50"),secondary:C("\u7d93\u4e0d\u540c\u5a92\u4ecb\u5206\u4eab\u7d66\u89aa\u53cb")})]})]}),Object(y.jsx)(ue.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:b,message:C("\u8cc7\u6599\u66f4\u65b0\u4e2d")+"..."}),Object(y.jsx)(ue.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:f,autoHideDuration:1500,onClose:function(t,e){O(!1)},message:C("\u7121\u6cd5\u7372\u5f97\u5730\u7406\u4f4d\u7f6e\u5b9a\u4f4d\u529f\u80fd\u6b0a\u9650")}),Object(y.jsx)(ue.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:v,autoHideDuration:1500,onClose:function(t,e){k(!1)},message:C("\u93c8\u7d50\u5df2\u8907\u88fd\u5230\u526a\u8cbc\u7c3f")})]})},Ie=Object(f.a)((function(t){return{root:{background:"white",height:"calc(100vh - 120px)"}}})),Ne=n(297),Ee=n(298),Te=n(166),ze=n.n(Te),Le=n(167),Me=n.n(Le),Re=n(168),Pe=n.n(Re),Be=n(169),Fe=n.n(Be),qe=function(){var t=Object(g.a)(),e=t.t,n=t.i18n,c=Object(u.h)(),o=Object(a.useContext)(N).selectedRoute;return Object(y.jsxs)(Ne.a,{value:c.pathname,showLabels:!0,children:[Object(y.jsx)(Ee.a,{label:e("\u5e38\u7528"),component:l.b,to:"/".concat(n.language),value:"/".concat(n.language),icon:Object(y.jsx)(ze.a,{})}),Object(y.jsx)(Ee.a,{label:e("\u641c\u5c0b"),component:l.b,to:"/".concat(n.language,"/search"),value:"/".concat(n.language,"/search"),icon:Object(y.jsx)(Me.a,{})}),Object(y.jsx)(Ee.a,{label:o.split("+")[0],component:l.b,to:"/".concat(n.language,"/route/").concat(o),value:"/".concat(n.language,"/route/").concat(o),icon:Object(y.jsx)(Pe.a,{})}),Object(y.jsx)(Ee.a,{label:e("\u8a2d\u5b9a"),component:l.b,to:"/".concat(n.language,"/settings"),value:"/".concat(n.language,"/settings"),icon:Object(y.jsx)(Fe.a,{})})]})},We=function(){var t=Object(u.j)().path;return Object(y.jsxs)(u.d,{children:[Object(y.jsx)(u.b,{path:"".concat(t,"/route/:id/:panel?"),children:Object(y.jsx)(oe,{})}),Object(y.jsx)(u.b,{path:"".concat(t,"/settings"),children:Object(y.jsx)(Ce,{})}),Object(y.jsx)(u.b,{path:"".concat(t,"/search"),children:Object(y.jsx)(kt,{})}),Object(y.jsx)(u.b,{path:"".concat(t),children:Object(y.jsx)(Q,{})})]})},Ae=function(){var t=Object(a.useContext)(N),e=t.routeList,n=t.stopList,c=Object(g.a)().t,o=De();return null==e||null==n?Object(y.jsxs)(b.a,{maxWidth:"xs",disableGutters:!0,className:o.loadingContainer,children:[Object(y.jsx)(d.a,{size:40}),Object(y.jsx)("br",{}),Object(y.jsx)("br",{}),Object(y.jsx)(j.a,{className:o.loadingTextContainer,elevation:0,children:null==n?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)(h.a,{variant:"subtitle2",align:"center",children:[c("\u521d\u59cb\u8a2d\u5b9a"),"..."]}),Object(y.jsxs)(h.a,{variant:"subtitle2",align:"center",children:[c("\u6b63\u5728\u66f4\u65b0\u5df4\u58eb\u8def\u7dda\u8cc7\u6599"),"..."]})]}):Object(y.jsx)(y.Fragment,{children:c("\u555f\u52d5\u4e2d")})})]}):Object(y.jsx)(i.a,{theme:Je,children:Object(y.jsx)(b.a,{maxWidth:"xs",disableGutters:!0,className:o.container,children:Object(y.jsxs)(l.a,{children:[Object(y.jsx)(u.b,{exact:!0,path:"/",children:Object(y.jsx)(u.a,{to:"/zh/"})}),Object(y.jsxs)(u.b,{path:"/:lang",children:[Object(y.jsx)(p.a,{}),Object(y.jsx)(R,{}),Object(y.jsx)(We,{}),Object(y.jsx)(qe,{})]})]})})})},Je=Object(s.a)({typography:{fontFamily:"Noto Sans TC, Chivo, sans-serif"},palette:{background:{default:"#ffff90"}}}),De=Object(f.a)((function(t){return{container:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100vh"},loadingContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh"}}})),He=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function _e(t,e){navigator.serviceWorker.register(t).then((function(t){t.onupdatefound=function(){var n=t.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),e&&e.onUpdate&&e.onUpdate(t)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(t)))})}})).catch((function(t){console.error("Error during service worker registration:",t)}))}var Ue=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,313)).then((function(e){var n=e.getCLS,a=e.getFID,c=e.getFCP,o=e.getLCP,r=e.getTTFB;n(t),a(t),c(t),o(t),r(t)}))},Ge=n(125),Ye=n(78),$e=n(170),Ve="en"===window.location.hash.substr(2,2)?"en":"zh";Ge.a.use(Ye.e).init({resources:$e,whitelist:["en","zh"],lowerCaseLng:!0,lng:Ve,nsSeparator:!1,keySeparator:!1,debug:!1,interpolation:{escapeValue:!1}});Ge.a;r.a.render(Object(y.jsx)(c.a.StrictMode,{children:Object(y.jsx)(I,{children:Object(y.jsx)(Ae,{})})}),document.getElementById("root")),function(t){if("serviceWorker"in navigator){if(new URL("/hk-independent-bus-eta",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/hk-independent-bus-eta","/service-worker.js");He?(!function(t,e){fetch(t,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(t){t.unregister().then((function(){window.location.reload()}))})):_e(t,e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e,t),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):_e(e,t)}))}}(),Ue()}},[[252,1,2]]]);